import{e as y,p as S,j as e,af as P,P as T,W as u,T as c,$ as C,E as l,ak as W,al as _,am as E,ab as h,t as q,a3 as M}from"../chunks/mui-core-cd9e8750.js";import{u as R,r as d,L as D}from"../chunks/react-vendor-9ee90314.js";import{a as L}from"../chunks/ui-vendor-11834b8a.js";import{a as F}from"../assets/index-fad1ea34.js";import{o as I}from"../chunks/mui-icons-f0327ae6.js";import"../chunks/query-vendor-0e167262.js";import"../chunks/utils-vendor-8faa4a85.js";const K=()=>{const x=R(),p=y();S(p.breakpoints.down("md"));const{enqueueSnackbar:m}=L(),[r,b]=d.useState({username:"",email:"",password:"",confirmPassword:"",full_name:"",phone:"",role:"cashier",store_id:1}),[n,g]=d.useState(!1),[w,V]=d.useState(!1),[j,B]=d.useState(!1),[s,f]=d.useState({}),t=a=>i=>{b(o=>({...o,[a]:i.target.value})),s[a]&&f(o=>({...o,[a]:""}))},k=()=>{const a={};return r.username.trim()?r.username.length<3&&(a.username="Tên đăng nhập phải có ít nhất 3 ký tự"):a.username="Tên đăng nhập là bắt buộc",r.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)||(a.email="Email không hợp lệ"):a.email="Email là bắt buộc",r.password?r.password.length<8&&(a.password="Mật khẩu phải có ít nhất 8 ký tự"):a.password="Mật khẩu là bắt buộc",r.confirmPassword?r.password!==r.confirmPassword&&(a.confirmPassword="Mật khẩu xác nhận không khớp"):a.confirmPassword="Xác nhận mật khẩu là bắt buộc",r.full_name.trim()||(a.full_name="Họ và tên là bắt buộc"),f(a),Object.keys(a).length===0},v=async a=>{if(a.preventDefault(),!!k()){g(!0);try{const i={username:r.username.trim(),email:r.email.trim(),password:r.password,full_name:r.full_name.trim(),phone:r.phone.trim()||null,role:r.role,store_id:r.store_id},o=await F.post("/users/register",i);o.success?(m("Đăng ký thành công! Vui lòng đăng nhập.",{variant:"success"}),x("/login")):m(o.message||"Đăng ký thất bại",{variant:"error"})}catch(i){console.error("Registration error:",i),m(i.response?.data?.message||"Lỗi kết nối. Vui lòng thử lại.",{variant:"error"})}finally{g(!1)}}};return e.jsx(P,{maxWidth:"sm",sx:{py:4},children:e.jsxs(T,{elevation:3,sx:{p:{xs:3,sm:4},borderRadius:3,background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)"},children:[e.jsxs(u,{sx:{textAlign:"center",mb:4},children:[e.jsx(u,{sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:80,height:80,borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",mb:2},children:e.jsx(I,{sx:{fontSize:40,color:"white"}})}),e.jsx(c,{variant:"h4",fontWeight:"bold",color:"primary.main",gutterBottom:!0,children:"Đăng ký tài khoản"}),e.jsx(c,{variant:"body1",color:"text.secondary",children:"Tạo tài khoản mới cho hệ thống SmartPOS"})]}),e.jsx(u,{component:"form",onSubmit:v,children:e.jsxs(C,{spacing:3,children:[e.jsx(l,{fullWidth:!0,label:"Tên đăng nhập",value:r.username,onChange:t("username"),error:!!s.username,helperText:s.username,disabled:n,required:!0}),e.jsx(l,{fullWidth:!0,type:"email",label:"Email",value:r.email,onChange:t("email"),error:!!s.email,helperText:s.email,disabled:n,required:!0}),e.jsx(l,{fullWidth:!0,label:"Họ và tên",value:r.full_name,onChange:t("full_name"),error:!!s.full_name,helperText:s.full_name,disabled:n,required:!0}),e.jsx(l,{fullWidth:!0,label:"Số điện thoại",value:r.phone,onChange:t("phone"),disabled:n}),e.jsxs(W,{fullWidth:!0,children:[e.jsx(_,{children:"Vai trò"}),e.jsxs(E,{value:r.role,onChange:t("role"),label:"Vai trò",disabled:n,children:[e.jsx(h,{value:"admin",children:"👑 Quản trị viên"}),e.jsx(h,{value:"manager",children:"👔 Quản lý"}),e.jsx(h,{value:"cashier",children:"💰 Thu ngân"}),e.jsx(h,{value:"inventory",children:"📦 Kho hàng"})]})]}),e.jsx(l,{fullWidth:!0,type:w?"text":"password",label:"Mật khẩu",value:r.password,onChange:t("password"),error:!!s.password,helperText:s.password,disabled:n,required:!0}),e.jsx(l,{fullWidth:!0,type:j?"text":"password",label:"Xác nhận mật khẩu",value:r.confirmPassword,onChange:t("confirmPassword"),error:!!s.confirmPassword,helperText:s.confirmPassword,disabled:n,required:!0}),e.jsx(q,{type:"submit",fullWidth:!0,variant:"contained",size:"large",disabled:n,sx:{py:1.5,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)","&:hover":{background:"linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%)"}},children:n?"Đang đăng ký...":"Đăng ký"}),e.jsx(M,{sx:{my:2}}),e.jsx(u,{sx:{textAlign:"center"},children:e.jsxs(c,{variant:"body2",color:"text.secondary",children:["Đã có tài khoản?"," ",e.jsx(D,{to:"/login",style:{color:p.palette.primary.main,textDecoration:"none",fontWeight:600},children:"Đăng nhập ngay"})]})})]})})]})})};export{K as default};
