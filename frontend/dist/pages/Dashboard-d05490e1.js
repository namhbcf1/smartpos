import{j as e,af as j,W as r,an as c,T as s,ae as z,t as O,V as $,I as E,C as b,aj as i,G as p,Y as h,Z as m,a8 as f,ao as U,P as y,a3 as v}from"../chunks/mui-core-cd9e8750.js";import{r as l}from"../chunks/react-vendor-9ee90314.js";import{a as R}from"../assets/index-fad1ea34.js";import{t as B,a as S,x as I,y as N,S as V,W as L,j as Y,P as G,z as q,F as H,G as J,J as Q,m as Z,p as X,K as _,O as ee,Q as se}from"../chunks/mui-icons-f0327ae6.js";import"../chunks/query-vendor-0e167262.js";import"../chunks/ui-vendor-11834b8a.js";import"../chunks/utils-vendor-8faa4a85.js";const le=()=>{const[o,W]=l.useState(null),[K,w]=l.useState(!0),[C,k]=l.useState(null),[x,P]=l.useState(!1),[t,D]=l.useState({database:{status:"connected",responseTime:45,lastSync:new Date().toISOString()},api:{status:"online",uptime:99.9},realtime:{status:"connected",activeConnections:1},performance:{memoryUsage:65,cpuUsage:23}}),[g,A]=l.useState(0),M=async()=>{const u=Date.now();try{w(!0),k(null),console.log("üöÄ Fetching dashboard data...");const a=await R.get("/api/v1/dashboard/stats"),d=Date.now()-u;if(console.log("üìä Dashboard API response:",a),a.data&&a.data.success&&a.data.data)W(a.data.data),D(n=>({...n,database:{status:"connected",responseTime:d,lastSync:new Date().toISOString()},api:{status:"online",uptime:99.9},realtime:{status:"connected",activeConnections:1},performance:{memoryUsage:Math.floor(Math.random()*30)+50,cpuUsage:Math.floor(Math.random()*20)+15}})),A(n=>n+1),console.log("‚úÖ Dashboard data loaded successfully");else throw new Error("Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu dashboard - Invalid response format")}catch(a){console.error("‚ùå Dashboard fetch error:",a),D(n=>({...n,database:{...n.database,status:"disconnected"},api:{...n.api,status:"offline"}}));let d="L·ªói kh√¥ng x√°c ƒë·ªãnh khi t·∫£i dashboard";if(a&&typeof a=="object"){if("message"in a&&typeof a.message=="string")d=a.message;else if("response"in a&&a.response&&typeof a.response=="object"){const n=a.response;n.data&&n.data.message?d=n.data.message:n.statusText&&(d=`HTTP Error: ${n.statusText}`)}}k(d)}finally{w(!1)}},T=async()=>{P(!0),await M(),P(!1)};if(l.useEffect(()=>{M()},[]),K)return e.jsx(j,{maxWidth:"xl",sx:{py:3},children:e.jsxs(r,{sx:{textAlign:"center"},children:[e.jsx(c,{sx:{mb:2}}),e.jsx(s,{variant:"h6",color:"text.secondary",children:"üîÑ ƒêang t·∫£i dashboard..."}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"K·∫øt n·ªëi t·ªõi Cloudflare D1 Database"})]})});if(C)return e.jsx(j,{maxWidth:"xl",sx:{py:3},children:e.jsxs(z,{severity:"error",sx:{mb:2},action:e.jsx(O,{color:"inherit",size:"small",onClick:T,disabled:x,startIcon:x?void 0:e.jsx(B,{}),children:x?"ƒêang th·ª≠ l·∫°i...":"Th·ª≠ l·∫°i"}),children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"‚ùå L·ªói k·∫øt n·ªëi Dashboard"}),e.jsx(s,{variant:"body2",children:C})]})});if(!o)return e.jsx(j,{maxWidth:"xl",sx:{py:3},children:e.jsxs(z,{severity:"warning",sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"‚ö†Ô∏è Kh√¥ng c√≥ d·ªØ li·ªáu dashboard"}),e.jsx(s,{variant:"body2",children:"Vui l√≤ng th·ª≠ l·∫°i ho·∫∑c li√™n h·ªá qu·∫£n tr·ªã vi√™n"})]})});const F=u=>{try{return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(u||0)}catch(a){return console.error("Currency formatting error:",a),`${u||0} ‚Ç´`}};return e.jsxs(j,{maxWidth:"xl",sx:{py:3},children:[e.jsxs(r,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(r,{children:[e.jsx(s,{variant:"h4",component:"h1",gutterBottom:!0,children:"üìä SmartPOS Dashboard"}),e.jsx(s,{variant:"body1",color:"text.secondary",children:"Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi h·ªá th·ªëng qu·∫£n l√Ω b√°n h√†ng th√¥ng minh"})]}),e.jsxs(r,{sx:{display:"flex",gap:1},children:[e.jsx($,{title:"L√†m m·ªõi d·ªØ li·ªáu",children:e.jsx(E,{onClick:T,disabled:x,color:"primary",size:"large",children:e.jsx(B,{})})}),e.jsx(b,{label:x?"ƒêang c·∫≠p nh·∫≠t...":"D·ªØ li·ªáu th·ªùi gian th·ª±c",color:x?"warning":"success",size:"medium",icon:e.jsx(S,{})})]})]}),e.jsxs(i,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(i,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{in:!0,timeout:500,children:e.jsx(h,{sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(102, 126, 234, 0.3)"}},children:e.jsxs(m,{children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(r,{children:[e.jsx(s,{color:"rgba(255,255,255,0.8)",gutterBottom:!0,variant:"body2",children:"üí∞ Doanh thu h√¥m nay"}),e.jsx(s,{variant:"h4",component:"div",sx:{fontWeight:"bold"},children:F(o.todayRevenue)}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(I,{sx:{fontSize:16,mr:.5}}),e.jsx(s,{variant:"caption",children:"+0% so v·ªõi h√¥m qua"})]})]}),e.jsx(f,{sx:{bgcolor:"rgba(255,255,255,0.2)",width:56,height:56},children:e.jsx(N,{sx:{fontSize:32}})})]}),e.jsx(c,{variant:"determinate",value:75,sx:{mt:2,bgcolor:"rgba(255,255,255,0.2)","& .MuiLinearProgress-bar":{bgcolor:"rgba(255,255,255,0.8)"}}})]})})},`revenue-${g}`)}),e.jsx(i,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{in:!0,timeout:700,children:e.jsx(h,{sx:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",color:"white",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(245, 87, 108, 0.3)"}},children:e.jsxs(m,{children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(r,{children:[e.jsx(s,{color:"rgba(255,255,255,0.8)",gutterBottom:!0,variant:"body2",children:"üõí ƒê∆°n h√†ng h√¥m nay"}),e.jsx(s,{variant:"h4",component:"div",sx:{fontWeight:"bold"},children:o.todaySales}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(I,{sx:{fontSize:16,mr:.5}}),e.jsx(s,{variant:"caption",children:"M·ª•c ti√™u: 10 ƒë∆°n/ng√†y"})]})]}),e.jsx(f,{sx:{bgcolor:"rgba(255,255,255,0.2)",width:56,height:56},children:e.jsx(V,{sx:{fontSize:32}})})]}),e.jsx(c,{variant:"determinate",value:o.todaySales/10*100,sx:{mt:2,bgcolor:"rgba(255,255,255,0.2)","& .MuiLinearProgress-bar":{bgcolor:"rgba(255,255,255,0.8)"}}})]})})},`sales-${g}`)}),e.jsx(i,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{in:!0,timeout:900,children:e.jsx(h,{sx:{background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",color:"white",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(79, 172, 254, 0.3)"}},children:e.jsxs(m,{children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(r,{children:[e.jsx(s,{color:"rgba(255,255,255,0.8)",gutterBottom:!0,variant:"body2",children:"üì¶ T·ªïng s·∫£n ph·∫©m"}),e.jsx(s,{variant:"h4",component:"div",sx:{fontWeight:"bold"},children:o.totalProducts}),e.jsx(r,{sx:{display:"flex",alignItems:"center",mt:1},children:o.lowStockProducts>0?e.jsxs(e.Fragment,{children:[e.jsx(L,{sx:{fontSize:16,mr:.5,color:"#ffeb3b"}}),e.jsxs(s,{variant:"caption",children:[o.lowStockProducts," s·∫Øp h·∫øt h√†ng"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{sx:{fontSize:16,mr:.5}}),e.jsx(s,{variant:"caption",children:"Kho h√†ng ·ªïn ƒë·ªãnh"})]})})]}),e.jsx(f,{sx:{bgcolor:"rgba(255,255,255,0.2)",width:56,height:56},children:e.jsx(Y,{sx:{fontSize:32}})})]}),e.jsx(c,{variant:"determinate",value:85,sx:{mt:2,bgcolor:"rgba(255,255,255,0.2)","& .MuiLinearProgress-bar":{bgcolor:"rgba(255,255,255,0.8)"}}})]})})},`products-${g}`)}),e.jsx(i,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{in:!0,timeout:1100,children:e.jsx(h,{sx:{background:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",color:"white",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 25px rgba(250, 112, 154, 0.3)"}},children:e.jsxs(m,{children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(r,{children:[e.jsx(s,{color:"rgba(255,255,255,0.8)",gutterBottom:!0,variant:"body2",children:"üë• T·ªïng kh√°ch h√†ng"}),e.jsx(s,{variant:"h4",component:"div",sx:{fontWeight:"bold"},children:o.totalCustomers}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(I,{sx:{fontSize:16,mr:.5}}),e.jsx(s,{variant:"caption",children:"+2 kh√°ch h√†ng m·ªõi"})]})]}),e.jsx(f,{sx:{bgcolor:"rgba(255,255,255,0.2)",width:56,height:56},children:e.jsx(G,{sx:{fontSize:32}})})]}),e.jsx(c,{variant:"determinate",value:60,sx:{mt:2,bgcolor:"rgba(255,255,255,0.2)","& .MuiLinearProgress-bar":{bgcolor:"rgba(255,255,255,0.8)"}}})]})})},`customers-${g}`)})]}),e.jsxs(i,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(i,{item:!0,xs:12,md:8,children:e.jsx(U,{direction:"up",in:!0,timeout:800,children:e.jsx(h,{sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:e.jsxs(m,{children:[e.jsxs(s,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center"},children:[e.jsx(q,{sx:{mr:1}}),"üñ•Ô∏è Tr·∫°ng th√°i h·ªá th·ªëng POS"]}),e.jsxs(i,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(y,{sx:{p:2,bgcolor:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(H,{sx:{mr:1,color:t.database.status==="connected"?"#4caf50":"#f44336"}}),e.jsx(s,{variant:"subtitle2",children:"Database Cloudflare D1"})]}),e.jsx(s,{variant:"h6",sx:{color:t.database.status==="connected"?"#4caf50":"#f44336"},children:t.database.status==="connected"?"üü¢ K·∫øt n·ªëi":"üî¥ M·∫•t k·∫øt n·ªëi"}),e.jsxs(s,{variant:"caption",children:["Ph·∫£n h·ªìi: ",t.database.responseTime,"ms"]}),e.jsx(c,{variant:"determinate",value:t.database.responseTime<100?100:Math.max(0,200-t.database.responseTime),sx:{mt:1,bgcolor:"rgba(255,255,255,0.2)","& .MuiLinearProgress-bar":{bgcolor:"#4caf50"}}})]})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(y,{sx:{p:2,bgcolor:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(J,{sx:{mr:1,color:t.api.status==="online"?"#4caf50":"#f44336"}}),e.jsx(s,{variant:"subtitle2",children:"API Cloudflare Workers"})]}),e.jsx(s,{variant:"h6",sx:{color:t.api.status==="online"?"#4caf50":"#f44336"},children:t.api.status==="online"?"üü¢ Ho·∫°t ƒë·ªông":"üî¥ Offline"}),e.jsxs(s,{variant:"caption",children:["Uptime: ",t.api.uptime,"%"]}),e.jsx(c,{variant:"determinate",value:t.api.uptime,sx:{mt:1,bgcolor:"rgba(255,255,255,0.2)","& .MuiLinearProgress-bar":{bgcolor:"#4caf50"}}})]})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(y,{sx:{p:2,bgcolor:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Q,{sx:{mr:1,color:t.performance.memoryUsage<80?"#4caf50":"#ff9800"}}),e.jsx(s,{variant:"subtitle2",children:"B·ªô nh·ªõ h·ªá th·ªëng"})]}),e.jsxs(s,{variant:"h6",sx:{color:t.performance.memoryUsage<80?"#4caf50":"#ff9800"},children:[t.performance.memoryUsage,"% ƒë√£ s·ª≠ d·ª•ng"]}),e.jsx(c,{variant:"determinate",value:t.performance.memoryUsage,sx:{mt:1,bgcolor:"rgba(255,255,255,0.2)","& .MuiLinearProgress-bar":{bgcolor:t.performance.memoryUsage<80?"#4caf50":"#ff9800"}}})]})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(y,{sx:{p:2,bgcolor:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Z,{sx:{mr:1,color:t.performance.cpuUsage<70?"#4caf50":"#ff9800"}}),e.jsx(s,{variant:"subtitle2",children:"CPU Usage"})]}),e.jsxs(s,{variant:"h6",sx:{color:t.performance.cpuUsage<70?"#4caf50":"#ff9800"},children:[t.performance.cpuUsage,"% ho·∫°t ƒë·ªông"]}),e.jsx(c,{variant:"determinate",value:t.performance.cpuUsage,sx:{mt:1,bgcolor:"rgba(255,255,255,0.2)","& .MuiLinearProgress-bar":{bgcolor:t.performance.cpuUsage<70?"#4caf50":"#ff9800"}}})]})})]})]})})})}),e.jsx(i,{item:!0,xs:12,md:4,children:e.jsx(U,{direction:"left",in:!0,timeout:1e3,children:e.jsx(h,{sx:{height:"100%"},children:e.jsxs(m,{children:[e.jsxs(s,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center"},children:[e.jsx(X,{sx:{mr:1,color:"primary.main"}}),"üìä Th√¥ng tin kinh doanh"]}),e.jsxs(r,{sx:{mb:2},children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"C·∫£nh b√°o t·ªìn kho"}),e.jsx(r,{sx:{display:"flex",alignItems:"center",mt:1},children:o.lowStockProducts>0?e.jsx(b,{icon:e.jsx(L,{}),label:`${o.lowStockProducts} s·∫£n ph·∫©m s·∫Øp h·∫øt`,color:"warning",size:"small"}):e.jsx(b,{icon:e.jsx(S,{}),label:"Kho h√†ng ·ªïn ƒë·ªãnh",color:"success",size:"small"})})]}),e.jsx(v,{sx:{my:2}}),e.jsxs(r,{sx:{mb:2},children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"ƒê∆°n h√†ng ch·ªù x·ª≠ l√Ω"}),e.jsx(s,{variant:"h4",color:"primary.main",children:o.pendingOrders})]}),e.jsx(v,{sx:{my:2}}),e.jsxs(r,{sx:{mb:2},children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"K·∫øt n·ªëi th·ªùi gian th·ª±c"}),e.jsx(r,{sx:{display:"flex",alignItems:"center",mt:1},children:e.jsx(b,{icon:t.realtime.status==="connected"?e.jsx(_,{}):e.jsx(ee,{}),label:t.realtime.status==="connected"?"ƒê√£ k·∫øt n·ªëi":"M·∫•t k·∫øt n·ªëi",color:t.realtime.status==="connected"?"success":"error",size:"small"})})]}),e.jsx(v,{sx:{my:2}}),e.jsx(r,{children:e.jsxs(s,{variant:"caption",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[e.jsx(se,{sx:{fontSize:14,mr:.5}}),"C·∫≠p nh·∫≠t l√∫c: ",new Date(o.timestamp).toLocaleString("vi-VN")]})})]})})})})]})]})};export{le as default};
