import{j as e,aj as c,P as S,W as a,a8 as v,T as o,ae as P,E as g,A as L,I,t as k,ad as A}from"../chunks/mui-core-cd9e8750.js";import{u as q,r as x,b as C,L as T}from"../chunks/react-vendor-9ee90314.js";import{u as W,C as h,c as p}from"../chunks/ui-vendor-11834b8a.js";import{u as z}from"../assets/index-fad1ea34.js";import{v as V,V as E,w as U}from"../chunks/mui-icons-f0327ae6.js";import"../chunks/query-vendor-0e167262.js";import"../chunks/utils-vendor-8faa4a85.js";const N=()=>{const n=q(),{login:b,isAuthenticated:i}=z(),[l,f]=x.useState(!1),[r,m]=x.useState(!1);C.useEffect(()=>{console.log("Login: isAuthenticated changed:",i),i&&(console.log("Login: Redirecting to dashboard..."),n("/dashboard",{replace:!0}))},[i,n]);const{control:u,handleSubmit:j,formState:{errors:t}}=W({defaultValues:{username:"",password:""},mode:"onSubmit"}),w=async s=>{m(!0);try{console.log("Login: Attempting login..."),await b(s.username,s.password),console.log("Login: Login API call successful"),p.success("Đăng nhập thành công"),setTimeout(()=>{console.log("Login: Manual redirect after timeout"),n("/dashboard",{replace:!0})},200)}catch(d){console.error("Login error:",d);const y=d?.response?.data?.message||d?.message||"Đăng nhập thất bại. Vui lòng thử lại.";p.error(y)}finally{m(!1)}};return e.jsxs(c,{container:!0,component:"main",sx:{height:"100vh"},children:[e.jsx(c,{item:!0,xs:!1,sm:4,md:7,sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center",position:"relative","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.3)",zIndex:1},"&::after":{content:'"SmartPOS"',position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"white",fontSize:"3rem",fontWeight:"bold",zIndex:2,textShadow:"2px 2px 4px rgba(0,0,0,0.5)"}}}),e.jsx(c,{item:!0,xs:12,sm:8,md:5,component:S,elevation:6,square:!0,children:e.jsxs(a,{sx:{my:8,mx:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(v,{sx:{m:1,bgcolor:"primary.main",width:56,height:56},children:e.jsx(V,{fontSize:"large"})}),e.jsx(o,{component:"h1",variant:"h5",sx:{mt:2},children:"SmartPOS Login"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1,mb:2},children:"Enter your credentials to access the system"}),e.jsxs(P,{severity:"info",sx:{mb:3,width:"100%"},children:[e.jsx("strong",{children:"Tài khoản demo:"}),e.jsx("br",{}),"Username: ",e.jsx("code",{children:"admin"}),e.jsx("br",{}),"Password: ",e.jsx("code",{children:"admin"})]}),e.jsxs(a,{component:"form",noValidate:!0,onSubmit:j(w),sx:{mt:1,width:"100%",maxWidth:"400px"},children:[e.jsx(h,{name:"username",control:u,rules:{required:"Username is required",minLength:{value:3,message:"Username must be at least 3 characters"}},render:({field:s})=>e.jsx(g,{...s,margin:"normal",required:!0,fullWidth:!0,id:"username",name:"username",label:"Username",autoComplete:"off",autoFocus:!0,error:!!t.username,helperText:t.username?.message,disabled:r,"aria-label":"Username input field"})}),e.jsx(h,{name:"password",control:u,rules:{required:"Password is required",minLength:{value:3,message:"Password must be at least 3 characters"}},render:({field:s})=>e.jsx(g,{...s,margin:"normal",required:!0,fullWidth:!0,label:"Password",type:l?"text":"password",id:"password",name:"password",autoComplete:"off",error:!!t.password,helperText:t.password?.message,disabled:r,"aria-label":"Password input field",InputProps:{endAdornment:e.jsx(L,{position:"end",children:e.jsx(I,{"aria-label":"toggle password visibility",onClick:()=>f(!l),edge:"end",children:l?e.jsx(E,{}):e.jsx(U,{})})})}})}),e.jsx(k,{type:"submit",fullWidth:!0,variant:"contained",disabled:r,sx:{mt:3,mb:2,py:1.5},"aria-label":"Sign in button",children:r?e.jsx(A,{size:24,color:"inherit"}):"Sign In"}),e.jsx(a,{sx:{mt:3,textAlign:"center"},children:e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Chưa có tài khoản?"," ",e.jsx(T,{to:"/register",style:{color:"#1976d2",textDecoration:"none",fontWeight:600},children:"Đăng ký ngay"})]})}),e.jsx(a,{sx:{mt:3},children:e.jsx(o,{variant:"body2",color:"text.secondary",align:"center",children:"Default login: admin / admin"})})]})]})})]})};export{N as default};
