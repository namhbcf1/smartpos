import{j as e,U as Be,V as oe,W as b,I as B,X as ue,Y as He,Z as qe,$ as Y,T as I,a0 as Ke,L as ne,w as Ae,a1 as H,a2 as q,C as Ge,a3 as F,t as U,a4 as J,s as N,a5 as Ye,a6 as Qe,a7 as Xe,a8 as Je,k as C,e as Ze,p as et,a9 as te,aa as ge,ab as W,ac as fe,F as xe,ad as Ce,ae as Pe,af as tt,P as st,ag as rt,ah as ot,ai as nt}from"../chunks/mui-core-cd9e8750.js";import{d as at,r as o,b as Re,u as it,f as ct,O as lt,N as ae,h as dt,i as d,B as ut}from"../chunks/react-vendor-9ee90314.js";import{Q as pt,a as ht}from"../chunks/query-vendor-0e167262.js";import{O as mt}from"../chunks/ui-vendor-11834b8a.js";import{a as gt}from"../chunks/utils-vendor-8faa4a85.js";import{C as ft,N as pe,W as ye,S as ie,P as Te,I as xt,E as Le,a as yt,b as se,c as bt,d as _t,M as vt,e as jt,A as It,f as be,L as Et,g as wt,h as St,D as kt,R as At,i as Ct,H as Pt,j as _e,k as Rt,B as Tt,l as Lt,m as Dt,n as Ot,o as zt,p as Nt,q as Vt,r as $t,s as ve,t as je,u as Mt}from"../chunks/mui-icons-f0327ae6.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(i){if(i.ep)return;i.ep=!0;const c=r(i);fetch(i.href,c)}})();var ce={},Ie=at;ce.createRoot=Ie.createRoot,ce.hydrateRoot=Ie.hydrateRoot;const Wt="modulepreload",Ft=function(t){return"/"+t},Ee={},u=function(s,r,n){if(!r||r.length===0)return s();const i=document.getElementsByTagName("link");return Promise.all(r.map(c=>{if(c=Ft(c),c in Ee)return;Ee[c]=!0;const l=c.endsWith(".css"),m=l?'[rel="stylesheet"]':"";if(!!n)for(let v=i.length-1;v>=0;v--){const E=i[v];if(E.href===c&&(!l||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${m}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":Wt,l||(f.as="script",f.crossOrigin=""),f.href=c,document.head.appendChild(f),l)return new Promise((v,E)=>{f.addEventListener("load",v),f.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${c}`)))})})).then(()=>s()).catch(c=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=c,window.dispatchEvent(l),!l.defaultPrevented)throw c})},De="https://smartpos-api-bangachieu2.bangachieu2.workers.dev/api/v1",le=De.replace(/\/$/,""),Ut=/\/api\/v1$/.test(le),he=Ut?le:`${le}/api/v1`,Bt=he;console.log("🌐 API Configuration:",{RAW_API_URL:De,resolvedBaseURL:he,environment:"production"});const h=gt.create({baseURL:he,headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0,timeout:1e4});let z=null;const Ht=()=>{try{const t=sessionStorage.getItem("user")||localStorage.getItem("user");return t?JSON.parse(t):null}catch(t){return console.error("Error parsing user from storage:",t),null}},Oe=()=>{sessionStorage.removeItem("user"),sessionStorage.removeItem("auth_token"),localStorage.removeItem("user"),localStorage.removeItem("auth_token"),z=null},qt=()=>{const t=sessionStorage.getItem("auth_token"),s=localStorage.getItem("auth_token");t?(z=t,console.log("🔐 API Service: Using sessionStorage token"),s&&s!==t&&(localStorage.removeItem("auth_token"),localStorage.removeItem("user"),console.log("🧹 API Service: Cleaned up old localStorage token"))):s&&(z=s,sessionStorage.setItem("auth_token",s),console.log("🔄 API Service: Migrated localStorage token to sessionStorage"),localStorage.removeItem("auth_token"),localStorage.removeItem("user"))};qt();h.interceptors.request.use(t=>(z?(t.headers.Authorization=`Bearer ${z}`,console.log("🔐 Adding auth token to request:",z.substring(0,20)+"...")):console.log("⚠️ No auth token available for request"),t.headers["X-Request-ID"]=crypto.randomUUID(),t.headers["X-Timestamp"]=new Date().toISOString(),console.log(`🚀 API Request: ${t.method?.toUpperCase()} ${t.url}`,{data:t.data,params:t.params,hasAuthToken:!!z,headers:{Authorization:t.headers.Authorization?"Bearer ***":"None","Content-Type":t.headers["Content-Type"]}}),t),t=>(console.error("❌ Request Error:",t),Promise.reject(t)));h.interceptors.response.use(t=>{if(console.log(`✅ API Response: ${t.config.method?.toUpperCase()} ${t.config.url}`,{status:t.status,success:t.data.success,data:t.data.data}),t.data.success)return t;{const s=new Error(t.data.error||"API request failed");return s.response=t,s.apiError=t.data,Promise.reject(s)}},t=>{if(console.error("❌ Response Error:",{status:t.response?.status,statusText:t.response?.statusText,url:t.config?.url,method:t.config?.method,data:t.response?.data}),t.response){const s=t.response.status,r=t.response.data;switch(s){case 401:Oe(),window.location.href="/login";break;case 403:console.error("Access denied:",r?.error);break;case 404:console.error("Resource not found:",r?.error);break;case 422:console.error("Validation error:",r?.error);break;case 429:console.error("Rate limited:",r?.error);break;case 500:console.error("Server error:",r?.error);break;default:console.error("API error:",r?.error)}const n=new Error(r?.error||`HTTP ${s}: ${t.response.statusText}`);return n.status=s,n.response=t.response,n.apiError=r,Promise.reject(n)}else if(t.request){const s=new Error("Network error - please check your connection");return s.request=t.request,Promise.reject(s)}else return Promise.reject(t)});const Q={login:async t=>(await h.post("/auth/login",t)).data,logout:async()=>{const t=await h.post("/auth/logout");return Oe(),t.data},register:async t=>(await h.post("/auth/register",t)).data,refresh:async()=>(await h.post("/auth/refresh")).data,me:async()=>(await h.get("/auth/me")).data},Kt={list:async(t=1,s=20)=>(await h.get("/users",{params:{page:t,limit:s}})).data,create:async t=>(await h.post("/users",t)).data,update:async(t,s)=>(await h.put(`/users/${t}`,s)).data,delete:async t=>(await h.delete(`/users/${t}`)).data,profile:async()=>(await h.get("/users/profile")).data},Gt={list:async t=>(await h.get("/products",{params:t})).data,create:async t=>(await h.post("/products",t)).data,update:async(t,s)=>(await h.put(`/products/${t}`,s)).data,delete:async t=>(await h.delete(`/products/${t}`)).data,detail:async t=>(await h.get(`/products/${t}`)).data,search:async(t,s=10)=>(await h.get("/products/search",{params:{q:t,limit:s}})).data},Yt={list:async t=>(await h.get("/sales",{params:t})).data,create:async t=>(await h.post("/sales",t)).data,update:async(t,s)=>(await h.put(`/sales/${t}`,s)).data,delete:async t=>(await h.delete(`/sales/${t}`)).data,detail:async t=>(await h.get(`/sales/${t}`)).data},Qt={list:async(t=1,s=20)=>(await h.get("/customers",{params:{page:t,limit:s}})).data,create:async t=>(await h.post("/customers",t)).data,update:async(t,s)=>(await h.put(`/customers/${t}`,s)).data,delete:async t=>(await h.delete(`/customers/${t}`)).data,detail:async t=>(await h.get(`/customers/${t}`)).data},Xt={list:async(t=1,s=20)=>(await h.get("/suppliers",{params:{page:t,limit:s}})).data,create:async t=>(await h.post("/suppliers",t)).data,update:async(t,s)=>(await h.put(`/suppliers/${t}`,s)).data,delete:async t=>(await h.delete(`/suppliers/${t}`)).data,detail:async t=>(await h.get(`/suppliers/${t}`)).data},Jt={transactions:async t=>(await h.get("/inventory/transactions",{params:t})).data,stockLevels:async()=>(await h.get("/inventory/stock-levels")).data,adjustments:async t=>(await h.post("/inventory/adjustments",t)).data,transfers:async t=>(await h.post("/inventory/transfers",t)).data},Zt={dashboard:async()=>(await h.get("/analytics/dashboard")).data,salesReport:async t=>(await h.get("/analytics/sales-report",{params:t})).data,inventoryReport:async t=>(await h.get("/analytics/inventory-report",{params:t})).data,customerReport:async t=>(await h.get("/analytics/customer-report",{params:t})).data},es=t=>{console.log("🔐 Setting auth token:",t.substring(0,20)+"..."),z=t,sessionStorage.setItem("auth_token",t),console.log("✅ Auth token set successfully")},ts=()=>z,ss=()=>!!z,rs=()=>Ht(),ze=Object.freeze(Object.defineProperty({__proto__:null,API_BASE_URL:Bt,analyticsAPI:Zt,authAPI:Q,customerAPI:Qt,default:h,getAuthToken:ts,getCurrentUser:rs,inventoryAPI:Jt,isAuthenticated:ss,productAPI:Gt,saleAPI:Yt,setAuthToken:es,supplierAPI:Xt,userAPI:Kt},Symbol.toStringTag,{value:"Module"}));var os=Object.defineProperty,ns=(t,s,r)=>s in t?os(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,re=(t,s,r)=>(ns(t,typeof s!="symbol"?s+"":s,r),r);class as{constructor(){re(this,"permissions",{}),re(this,"permissionsLoaded",!1),re(this,"currentUserId",null)}async loadUserPermissions(s){try{if(this.currentUserId===s&&this.permissionsLoaded)return;const r=await h.get("/permissions/me");r.success&&r.data&&(this.permissions={},r.data.forEach(n=>{this.permissions[n.permission_key]=n.has_permission}),this.permissionsLoaded=!0,this.currentUserId=s,console.log("🔐 User permissions loaded:",Object.keys(this.permissions).length,"permissions"))}catch(r){console.error("Error loading user permissions:",r),this.permissions={},this.permissionsLoaded=!1}}hasPermission(s){return this.permissionsLoaded?this.permissions[s]===!0:(console.warn("Permissions not loaded yet, defaulting to false for:",s),!1)}hasAnyPermission(s){return s.some(r=>this.hasPermission(r))}hasAllPermissions(s){return s.every(r=>this.hasPermission(r))}getAllPermissions(){return{...this.permissions}}canAccessMenu(s){return this.hasPermission(`${s}.access`)}canPerformAction(s,r){return this.hasPermission(`${s}.${r}`)}canAccessTable(s,r){return this.hasPermission(`${s}_table.${r}`)}canUseFeature(s,r="view"){return this.hasPermission(`${s}.${r}`)}clearPermissions(){this.permissions={},this.permissionsLoaded=!1,this.currentUserId=null}async refreshPermissions(){this.currentUserId&&(this.permissionsLoaded=!1,await this.loadUserPermissions(this.currentUserId))}getPermissionStatus(){return{loaded:this.permissionsLoaded,userId:this.currentUserId,permissionCount:Object.keys(this.permissions).length,permissions:this.getAllPermissions()}}}const A=new as,is=()=>({hasPermission:t=>A.hasPermission(t),hasAnyPermission:t=>A.hasAnyPermission(t),hasAllPermissions:t=>A.hasAllPermissions(t),canAccessMenu:t=>A.canAccessMenu(t),canPerformAction:(t,s)=>A.canPerformAction(t,s),canAccessTable:(t,s)=>A.canAccessTable(t,s),canUseFeature:(t,s)=>A.canUseFeature(t,s),getAllPermissions:()=>A.getAllPermissions(),refreshPermissions:()=>A.refreshPermissions(),getPermissionStatus:()=>A.getPermissionStatus()}),Ne=o.createContext({user:null,isAuthenticated:!1,isLoading:!0,login:async()=>{},logout:async()=>{},checkAuth:async()=>!1,checkAuthSilent:async()=>!1}),cs=({children:t})=>{const[s,r]=o.useState(null),[n,i]=o.useState(!1),[c,l]=o.useState(!0);o.useEffect(()=>{(async()=>{console.log("🔐 AuthContext: Initializing authentication...");const L=sessionStorage.getItem("auth_token"),S=sessionStorage.getItem("user");if(L&&S){console.log("🔐 AuthContext: Found stored session, validating...");try{if(await E()){const O=JSON.parse(S);r(O),i(!0),console.log("✅ AuthContext: Session validated successfully");try{await A.loadUserPermissions(O.id),console.log("✅ AuthContext: User permissions loaded from stored session")}catch(j){console.error("❌ AuthContext: Failed to load permissions from stored session:",j)}}else console.log("❌ AuthContext: Session invalid, clearing..."),m()}catch(D){console.error("❌ AuthContext: Failed to validate session:",D),m()}}else console.log("🔐 AuthContext: No stored session found"),r(null),i(!1);l(!1)})()},[]);const m=()=>{sessionStorage.removeItem("auth_token"),sessionStorage.removeItem("user"),localStorage.removeItem("auth_token"),localStorage.removeItem("user"),r(null),i(!1),A.clearPermissions()},x=async(_,L)=>{try{l(!0),console.log("🔐 AuthContext: Starting login...");const S=await Q.login({username:_,password:L});if(S.success&&S.data){const{user:D,token:O}=S.data;console.log("✅ AuthContext: Login successful"),r(D),i(!0),sessionStorage.setItem("user",JSON.stringify(D)),sessionStorage.setItem("auth_token",O);const{setAuthToken:j}=await u(()=>Promise.resolve().then(()=>ze),void 0);j(O);try{await A.loadUserPermissions(D.id),console.log("✅ AuthContext: User permissions loaded")}catch(V){console.error("❌ AuthContext: Failed to load permissions:",V)}}else throw new Error(S.error||"Login failed")}catch(S){throw console.error("❌ AuthContext: Login failed:",S),m(),S}finally{l(!1)}},f=async()=>{try{l(!0),console.log("🔐 AuthContext: Logging out..."),await Q.logout(),console.log("✅ AuthContext: Logout successful")}catch(_){console.error("❌ AuthContext: Logout API failed:",_)}finally{m(),l(!1)}},v=async()=>{try{console.log("🔐 AuthContext: Checking authentication...");const _=await Q.me();if(_.success&&_.data){r(_.data),i(!0),sessionStorage.setItem("user",JSON.stringify(_.data)),console.log("✅ AuthContext: Authentication valid");try{await A.loadUserPermissions(_.data.id),console.log("✅ AuthContext: User permissions loaded from checkAuth")}catch(L){console.error("❌ AuthContext: Failed to load permissions from checkAuth:",L)}return!0}else return m(),console.log("❌ AuthContext: Authentication invalid"),!1}catch(_){return console.error("❌ AuthContext: Auth check failed:",_),m(),!1}},E=async()=>{try{const _=await Q.me();return _.success&&_.data?(r(_.data),i(!0),sessionStorage.setItem("user",JSON.stringify(_.data)),!0):(m(),!1)}catch{return m(),!1}},w={user:s,isAuthenticated:n,isLoading:c,login:x,logout:f,checkAuth:v,checkAuthSilent:E};return e.jsx(Ne.Provider,{value:w,children:t})},Ve=()=>{const t=o.useContext(Ne);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},de=240,Dr=t=>t==null||isNaN(t)?"0 ₫":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),Or=t=>{if(!t)return"Chưa có thông tin";const s=new Date(t);return isNaN(s.getTime())?"Ngày không hợp lệ":new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(s)},zr=t=>{if(!t)return"Chưa có";const s=new Date(t);return isNaN(s.getTime())?"Không hợp lệ":new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}).format(s)},g={primary:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e"},secondary:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f"},success:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b"},error:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d"},warning:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f"},info:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63"},gray:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a"}},K={primary:"linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%)",secondary:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",success:"linear-gradient(135deg, #10b981 0%, #059669 100%)",error:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",warning:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",info:"linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)"},P={soft:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",medium:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",large:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",colored:{primary:"0 10px 15px -3px rgba(14, 165, 233, 0.3), 0 4px 6px -2px rgba(14, 165, 233, 0.1)",secondary:"0 10px 15px -3px rgba(168, 85, 247, 0.3), 0 4px 6px -2px rgba(168, 85, 247, 0.1)"}},ls={fontFamily:["Inter","Roboto","system-ui","-apple-system","BlinkMacSystemFont",'"Segoe UI"',"sans-serif"].join(",")},X={borderRadius:12,borderRadiusLarge:20,borderRadiusSmall:8},ds={MuiButton:{styleOverrides:{root:{borderRadius:X.borderRadius,padding:"12px 24px",fontSize:"0.875rem",fontWeight:600,textTransform:"none",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"},containedPrimary:{background:K.primary,boxShadow:P.colored.primary,"&:hover":{transform:"translateY(-2px)",boxShadow:`${P.colored.primary}, 0 20px 25px -5px rgba(14, 165, 233, 0.2)`}}}},MuiCard:{styleOverrides:{root:{borderRadius:X.borderRadiusLarge,background:"rgba(255, 255, 255, 0.95)",backgroundImage:"none",backdropFilter:"blur(20px)",border:`1px solid ${g.gray[200]}`,boxShadow:P.soft,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateY(-4px)",boxShadow:P.large,borderColor:g.gray[300]}}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:X.borderRadius,backgroundColor:"rgba(248, 250, 252, 0.8)",backdropFilter:"blur(10px)",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",color:"#1e293b","&:hover":{backgroundColor:"rgba(248, 250, 252, 0.9)","& .MuiOutlinedInput-notchedOutline":{borderColor:g.primary[500]}},"&.Mui-focused":{backgroundColor:"rgba(255, 255, 255, 1)",transform:"translateY(-2px)",boxShadow:P.colored.primary,"& .MuiOutlinedInput-notchedOutline":{borderColor:g.primary[500],borderWidth:2}}},"& .MuiInputLabel-root":{color:"#64748b",fontWeight:500,"&.Mui-focused":{color:g.primary[500]}}}}},MuiTableCell:{styleOverrides:{root:{padding:"16px 20px",borderBottom:`1px solid ${g.gray[200]}`,color:"#1e293b"},head:{fontWeight:700,fontSize:"0.875rem",color:"#475569",backgroundColor:"rgba(248, 250, 252, 0.8)",textTransform:"uppercase",letterSpacing:"0.05em"}}},MuiTableRow:{styleOverrides:{root:{transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{backgroundColor:"rgba(14, 165, 233, 0.05)",transform:"scale(1.01)"}}}},MuiChip:{styleOverrides:{root:{borderRadius:20,fontWeight:600,fontSize:"0.75rem"},colorPrimary:{backgroundColor:g.primary[100],color:g.primary[800]},colorSuccess:{backgroundColor:g.success[100],color:g.success[600]},colorError:{backgroundColor:g.error[100],color:g.error[600]}}},MuiDialog:{styleOverrides:{paper:{borderRadius:24,background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",border:`1px solid ${g.gray[200]}`,boxShadow:P.large}}}},us=Be({palette:{mode:"light",primary:{main:"#0ea5e9",light:"#38bdf8",dark:"#0284c7",contrastText:"#ffffff"},secondary:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706",contrastText:"#ffffff"},success:{main:"#10b981",light:"#34d399",dark:"#059669",contrastText:"#ffffff"},error:{main:"#ef4444",light:"#f87171",dark:"#dc2626",contrastText:"#ffffff"},warning:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706",contrastText:"#ffffff"},info:{main:"#06b6d4",light:"#22d3ee",dark:"#0891b2",contrastText:"#ffffff"},background:{default:"#f8fafc",paper:"#ffffff"},text:{primary:"#1e293b",secondary:"#64748b"},divider:"#e2e8f0",grey:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a"}},typography:{fontFamily:ls.fontFamily,h1:{fontSize:"3rem",fontWeight:800,lineHeight:1.2,letterSpacing:"-0.025em",background:K.primary,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},h2:{fontSize:"2.25rem",fontWeight:700,lineHeight:1.3,letterSpacing:"-0.025em",color:"#1e293b"},h3:{fontSize:"1.875rem",fontWeight:600,lineHeight:1.4,letterSpacing:"-0.025em",color:"#334155"},h4:{fontSize:"1.5rem",fontWeight:600,lineHeight:1.4,color:"#334155"},h5:{fontSize:"1.25rem",fontWeight:600,lineHeight:1.5,color:"#475569"},h6:{fontSize:"1.125rem",fontWeight:600,lineHeight:1.5,color:"#475569"},body1:{fontSize:"1rem",lineHeight:1.6,color:"#475569"},body2:{fontSize:"0.875rem",lineHeight:1.6,color:"#64748b"},caption:{fontSize:"0.75rem",lineHeight:1.5,color:"#94a3b8",fontWeight:500},button:{textTransform:"none",fontWeight:600,fontSize:"0.875rem",letterSpacing:"0.025em"}},components:ds,shape:{borderRadius:X.borderRadius},shadows:["none",P.soft,P.medium,P.large,"0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)","0 25px 50px -12px rgba(0, 0, 0, 0.25)"]});var ps=Object.defineProperty,hs=(t,s,r)=>s in t?ps(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,R=(t,s,r)=>(hs(t,typeof s!="symbol"?s+"":s,r),r);class ms{constructor(){R(this,"events",{})}on(s,r){this.events[s]||(this.events[s]=[]),this.events[s].push(r)}off(s,r){this.events[s]&&(this.events[s]=this.events[s].filter(n=>n!==r))}emit(s,...r){this.events[s]&&this.events[s].forEach(n=>{try{n(...r)}catch(i){console.error(`Error in event listener for ${s}:`,i)}})}removeAllListeners(s){s?delete this.events[s]:this.events={}}}class gs extends ms{constructor(){super(),R(this,"ws",null),R(this,"reconnectAttempts",0),R(this,"maxReconnectAttempts",3),R(this,"reconnectDelay",5e3),R(this,"isConnecting",!1),R(this,"isManuallyDisconnected",!1),R(this,"heartbeatInterval",null),R(this,"connectionId",null),R(this,"eventListeners",new Map),R(this,"pollingInterval",null),R(this,"lastDataHash",""),R(this,"usePollingFallback",!1),R(this,"pollingDelay",5e3),this.setupEventListeners(),console.log("🔄 Enabling polling for real-time features"),this.usePollingFallback=!0,this.startPollingFallback()}async connect(){if(!this.isConnecting){this.isConnecting=!0,this.isManuallyDisconnected=!1;try{const s=this.getWebSocketUrl();console.log("🔌 Attempting WebSocket connection to:",s);try{this.ws=new WebSocket(s),this.setupWebSocketHandlers(),await new Promise((r,n)=>{const i=setTimeout(()=>{n(new Error("WebSocket connection timeout"))},5e3);this.ws.onopen=()=>{clearTimeout(i),console.log("✅ WebSocket connected successfully"),this.usePollingFallback=!1,this.emit("connected"),r()},this.ws.onerror=c=>{clearTimeout(i),n(c)}})}catch{Math.random()<.05&&console.warn("⚠️ WebSocket failed, falling back to polling"),this.usePollingFallback=!0,this.startPollingFallback(),this.emit("connected"),Math.random()<.1&&console.log("✅ Realtime service connected via polling fallback")}}catch(s){console.error("❌ Failed to connect to realtime service:",s),this.emit("error",s)}finally{this.isConnecting=!1}}}disconnect(){this.isManuallyDisconnected=!0,this.ws&&(this.ws.close(),this.ws=null),this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),this.stopPollingFallback(),this.emit("disconnected"),console.log("🔌 Realtime service disconnected")}subscribe(s,r){this.eventListeners.has(s)||this.eventListeners.set(s,new Set);const n=this.eventListeners.get(s),i=n.size===0;n.add(r),i&&console.log(`📡 Subscribed to ${s} events`)}unsubscribe(s,r){if(!this.eventListeners.has(s))return;const n=this.eventListeners.get(s);r?n.delete(r):n.clear(),n.size===0&&console.log(`📡 Unsubscribed from ${s} events`)}send(s){this.ws&&this.ws.readyState===WebSocket.OPEN?(this.ws.send(JSON.stringify(s)),console.log("📤 Sent event:",s.type)):console.warn("⚠️ Cannot send event: not connected to realtime service")}subscribeToProduct(s){this.send({type:"subscribe",data:{type:"product",productId:s},timestamp:Date.now()})}unsubscribeFromProduct(s){this.send({type:"unsubscribe",data:{type:"product",productId:s},timestamp:Date.now()})}subscribeToInventory(){this.send({type:"subscribe",data:{type:"inventory"},timestamp:Date.now()})}subscribeToSales(){this.send({type:"subscribe",data:{type:"sales"},timestamp:Date.now()})}subscribeToSerialNumbers(){this.send({type:"subscribe",data:{type:"serial_numbers"},timestamp:Date.now()})}subscribeToSystemEvents(){this.send({type:"subscribe",data:{type:"system"},timestamp:Date.now()})}isConnected(){return this.ws?.readyState===WebSocket.OPEN}getConnectionInfo(){return{connected:this.isConnected(),id:this.connectionId,attempts:this.reconnectAttempts}}setupEventListeners(){this.on("event",s=>{const r=this.eventListeners.get(s.type);r&&r.forEach(n=>{try{n(s)}catch(i){console.error(`Error in event listener for ${s.type}:`,i)}})})}scheduleReconnect(){if(this.isManuallyDisconnected||this.reconnectAttempts>=this.maxReconnectAttempts)return;const s=this.reconnectDelay*Math.pow(2,this.reconnectAttempts);this.reconnectAttempts++,(this.reconnectAttempts<=3||this.reconnectAttempts%5===0)&&console.log(`🔄 Scheduling reconnect attempt ${this.reconnectAttempts} in ${s}ms`),setTimeout(()=>{this.isManuallyDisconnected||this.connect()},s)}getWebSocketUrl(){const s="https://smartpos-api-bangachieu2.bangachieu2.workers.dev/api/v1",r=new URL(s).host;return`${s.startsWith("https:")?"wss:":"ws:"}//${r}/ws`}setupWebSocketHandlers(){this.ws&&(this.ws.onmessage=s=>{try{const r=JSON.parse(s.data);switch(console.log("📨 Received WebSocket message:",r),r.type){case"connected":console.log("✅ WebSocket connected:",r.data?.message),this.emit("connected",r);break;case"pong":this.handleHeartbeat(r);break;case"subscription_confirmed":console.log("📡 Subscription confirmed:",r.data?.type);break;case"unsubscription_confirmed":console.log("📡 Unsubscription confirmed:",r.data?.type);break;case"error":console.error("❌ Server error:",r.message),this.emit("error",new Error(r.message));break;case"user_login":case"user_logout":case"system_alert":case"backup_completed":case"stock_updated":case"stock_low":case"stock_out":case"product_updated":case"inventory_updated":case"sale_completed":case"serial_number_updated":case"inventory_alert":case"analytics_updated":case"user_created":case"user_updated":case"role_changed":case"permission_updated":case"database_optimized":case"maintenance_completed":case"backup_created":case"performance_alert":case"security_alert":case"notification":this.emit(r.type,r),this.emit("event",r);break;default:this.emit("event",r)}}catch(r){console.error("❌ Error parsing WebSocket message:",r)}},this.ws.onclose=s=>{Math.random()<.1&&console.log("🔌 WebSocket connection closed:",s.code,s.reason),this.ws=null,this.connectionId=null,this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null),this.emit("disconnected"),this.isManuallyDisconnected||this.scheduleReconnect()},this.ws.onerror=s=>{Math.random()<.05&&console.error("❌ WebSocket error:",s),this.emit("error",s)})}startHeartbeat(){this.heartbeatInterval=setInterval(()=>{this.ws&&this.ws.readyState===WebSocket.OPEN&&this.send({type:"ping",data:{},timestamp:Date.now()})},3e4)}handleHeartbeat(s){s.connectionId&&(this.connectionId=s.connectionId),this.emit("heartbeat",s)}startPollingFallback(){this.pollingInterval&&clearInterval(this.pollingInterval),console.log("🔄 Starting polling fallback for real-time updates"),this.emit("connected"),this.pollingInterval=setInterval(async()=>{try{await this.pollForUpdates()}catch(s){Math.random()<.1&&console.error("❌ Polling error:",s)}},6e4),setTimeout(()=>{this.pollForUpdates()},1e3)}async pollForUpdates(){try{const{default:s}=await u(()=>Promise.resolve().then(()=>ze),void 0),r=await s.get("/api/v1/dashboard/stats");if(r&&r.data&&r.data.success&&r.data.data){const n=r.data,i=JSON.stringify(n);i!==this.lastDataHash&&(this.lastDataHash=i,Math.random()<.1&&console.log("📊 Dashboard data updated via polling:",n.data),this.emit("dashboard_updated",n),n.data?.todaySales!==void 0&&this.emit("sales_updated",{type:"sales_updated",data:{todaySales:n.data.todaySales},timestamp:Date.now()}),n.data?.totalCustomers!==void 0&&this.emit("customer_updated",{type:"customer_updated",data:{totalCustomers:n.data.totalCustomers},timestamp:Date.now()}),n.data?.totalProducts!==void 0&&this.emit("inventory_updated",{type:"inventory_updated",data:{totalProducts:n.data.totalProducts},timestamp:Date.now()}),this.emit("system_status",{type:"system_status",data:{status:"operational",timestamp:new Date().toISOString(),activeUsers:1,systemLoad:"low",pollingActive:!0},timestamp:Date.now()}))}else Math.random()<.01&&console.warn("⚠️ Failed to fetch dashboard stats via polling")}catch(s){Math.random()<.01&&console.error("❌ Failed to poll for updates:",s)}}stopPollingFallback(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null),this.usePollingFallback=!1}generateConnectionId(){return`conn_${Date.now()}_${Math.random().toString(36).substring(2,11)}`}}const k=new gs,fs=()=>{const[t,s]=o.useState(!1),[r,n]=o.useState({connected:!1,id:null,attempts:0});o.useEffect(()=>{const l=()=>{s(!0),n(k.getConnectionInfo())},m=()=>{s(!1),n(k.getConnectionInfo())},x=f=>{console.error("Realtime connection error:",f),s(!1)};return k.on("connected",l),k.on("disconnected",m),k.on("error",x),k.connect(),()=>{k.off("connected",l),k.off("disconnected",m),k.off("error",x)}},[]);const i=o.useCallback(()=>{k.connect()},[]),c=o.useCallback(()=>{k.disconnect()},[]);return{isConnected:t,connectionInfo:r,connect:i,disconnect:c}},Z=(t,s,r=[])=>{const n=o.useRef(s),[i,c]=o.useState([]),[l,m]=o.useState(null),x=o.useRef([]);o.useEffect(()=>{n.current=s},[s]),o.useEffect(()=>{if(!(t.length!==x.current.length||t.some((w,_)=>w!==x.current[_])))return;const E=w=>{n.current(w),m(w),c(_=>[..._.slice(-99),w])};return x.current.forEach(w=>{k.unsubscribe(w,E)}),t.forEach(w=>{k.subscribe(w,E)}),x.current=[...t],()=>{t.forEach(w=>{k.unsubscribe(w,E)})}},[t.join(","),...r]);const f=o.useCallback(()=>{c([]),m(null)},[]);return{events:i,lastEvent:l,clearEvents:f}},xs=t=>{const[s,r]=o.useState({todayTotal:0,todayCount:0,recentSales:[]}),n=o.useCallback(l=>{console.log("📊 Sales event received:",l),l.type==="sale_created"&&r(m=>({todayTotal:m.todayTotal+l.data.total_amount,todayCount:m.todayCount+1,recentSales:[l.data,...m.recentSales.slice(0,9)]})),t&&t(l)},[t]),{events:i,lastEvent:c}=Z(["sale_created","sale_updated","sale_deleted"],n);return{salesStats:s,salesEvents:i,lastSalesEvent:c,setSalesStats:r}},$e=t=>{const[s,r]=o.useState([]),[n,i]=o.useState(0),c=o.useCallback(f=>{console.log("📦 Inventory event received:",f),f.type==="stock_updated"&&f.data.current_stock<=f.data.min_stock_level&&(r(v=>[{id:Date.now(),product_name:f.data.product_name,current_stock:f.data.current_stock,min_stock_level:f.data.min_stock_level,timestamp:f.timestamp},...v.slice(0,19)]),i(v=>v+1)),t&&t(f)},[t]),{events:l,lastEvent:m}=Z(["stock_updated","stock_low","stock_out"],c),x=o.useCallback(()=>{r([]),i(0)},[]);return{inventoryAlerts:s,lowStockCount:n,inventoryEvents:l,lastInventoryEvent:m,clearAlerts:x}},ys=t=>{const[s,r]=o.useState({newCustomersToday:0,totalLoyaltyPoints:0,vipCustomers:0}),n=o.useCallback(l=>{console.log("👥 Customer event received:",l),l.type==="customer_created"&&r(m=>({...m,newCustomersToday:m.newCustomersToday+1})),l.type==="loyalty_points_changed"&&r(m=>({...m,totalLoyaltyPoints:m.totalLoyaltyPoints+(l.data.points_change||0)})),t&&t(l)},[t]),{events:i,lastEvent:c}=Z(["customer_created","customer_updated","loyalty_points_changed"],n);return{customerStats:s,customerEvents:i,lastCustomerEvent:c,setCustomerStats:r}},Me=t=>{const[s,r]=o.useState([]),[n,i]=o.useState({status:"online",lastHeartbeat:Date.now(),uptime:0}),c=o.useCallback(v=>{console.log("🔧 System event received:",v),v.type==="system_alert"&&r(E=>[{id:Date.now(),message:v.data.message,level:v.data.level,timestamp:v.timestamp},...E.slice(0,9)]),t&&t(v)},[t]),{events:l,lastEvent:m}=Z(["user_login","user_logout","system_alert","backup_completed"],c),x=o.useRef(null);o.useEffect(()=>(x.current||(x.current=v=>{i(E=>({...E,lastHeartbeat:v.timestamp,status:"online"}))},k.on("heartbeat",x.current)),()=>{x.current&&(k.off("heartbeat",x.current),x.current=null)}),[]);const f=o.useCallback(()=>{r([])},[]);return{systemAlerts:s,systemStatus:n,systemEvents:l,lastSystemEvent:m,clearAlerts:f}},bs=()=>{const{isConnected:t}=fs();return e.jsx(oe,{title:t?"Realtime: Kết nối":"Realtime: Mất kết nối",children:e.jsx(b,{sx:{display:"flex",alignItems:"center"},children:e.jsx(ft,{sx:{fontSize:8,color:t?"success.main":"error.main",animation:t?"blink 2s infinite":"none","@keyframes blink":{"0%, 50%":{opacity:1},"51%, 100%":{opacity:.3}}}})})})},_s=t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),vs=t=>new Date(t).toLocaleString("vi-VN"),js=({maxItems:t=10,autoHide:s=!1,hideAfter:r=5})=>{const[n,i]=o.useState(!1),[c,l]=o.useState([]),{systemAlerts:m,clearAlerts:x}=Me(),{inventoryAlerts:f,clearAlerts:v}=$e(),{salesEvents:E}=xs(),{customerEvents:w}=ys();o.useEffect(()=>{const V=[...m.map(y=>({...y,type:"system",icon:_(y.level),color:L(y.level)})),...f.map(y=>({...y,type:"inventory",icon:e.jsx(ye,{}),color:"warning",message:`Sản phẩm "${y.product_name}" sắp hết hàng (${y.current_stock}/${y.min_stock_level})`})),...E.slice(-5).map(y=>({id:`sale-${y.timestamp}`,type:"sales",icon:e.jsx(ie,{}),color:"success",message:`Đơn hàng mới: ${y.data.sale_number} - ${_s(y.data.total_amount)}`,timestamp:y.timestamp})),...w.slice(-3).map(y=>({id:`customer-${y.timestamp}`,type:"customers",icon:e.jsx(Te,{}),color:"info",message:y.type==="customer_created"?`Khách hàng mới: ${y.data.name}`:`Cập nhật khách hàng: ${y.data.name}`,timestamp:y.timestamp}))].sort((y,ee)=>(ee.timestamp||0)-(y.timestamp||0)).slice(0,t);l(V)},[m,f,E,w,t]),o.useEffect(()=>{if(s&&c.length>0){const j=setTimeout(()=>{l([])},r*1e3);return()=>clearTimeout(j)}},[c,s,r]);const _=j=>{switch(j){case"success":return e.jsx(yt,{});case"warning":return e.jsx(ye,{});case"error":return e.jsx(Le,{});default:return e.jsx(xt,{})}},L=j=>{switch(j){case"success":return"success";case"warning":return"warning";case"error":return"error";default:return"info"}},S=()=>{l([]),x(),v()},D=j=>{l(V=>V.filter(y=>y.id!==j))},O=c.length;return e.jsx(He,{sx:{minWidth:300,maxWidth:400},children:e.jsxs(qe,{sx:{pb:1},children:[e.jsxs(Y,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(Y,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(ue,{badgeContent:O,color:"error",max:99,children:e.jsx(pe,{})}),e.jsx(I,{variant:"h6",children:"Thông báo trực tiếp"})]}),e.jsxs(Y,{direction:"row",spacing:1,children:[c.length>0&&e.jsx(B,{size:"small",onClick:S,children:e.jsx(se,{})}),e.jsx(B,{size:"small",onClick:()=>i(!n),children:n?e.jsx(bt,{}):e.jsx(_t,{})})]})]}),e.jsx(Ke,{in:n,children:e.jsxs(b,{sx:{mt:2},children:[c.length===0?e.jsx(b,{sx:{textAlign:"center",py:2},children:e.jsx(I,{variant:"body2",color:"text.secondary",children:"Không có thông báo mới"})}):e.jsx(ne,{dense:!0,sx:{maxHeight:300,overflow:"auto"},children:c.map((j,V)=>e.jsxs(Re.Fragment,{children:[e.jsxs(Ae,{sx:{px:0,py:1,"&:hover":{backgroundColor:"action.hover",borderRadius:1}},children:[e.jsx(H,{sx:{minWidth:40},children:e.jsx(b,{sx:{color:`${j.color}.main`},children:j.icon})}),e.jsx(q,{primary:e.jsx(I,{variant:"body2",sx:{fontWeight:500},children:j.message}),secondary:e.jsxs(Y,{direction:"row",alignItems:"center",spacing:1,sx:{mt:.5},children:[e.jsx(Ge,{label:j.type,size:"small",color:j.color,variant:"outlined",sx:{fontSize:"0.7rem",height:20}}),j.timestamp&&e.jsx(I,{variant:"caption",color:"text.secondary",children:vs(new Date(j.timestamp))})]})}),e.jsx(B,{size:"small",onClick:()=>D(j.id),sx:{ml:1},children:e.jsx(se,{fontSize:"small"})})]}),V<c.length-1&&e.jsx(F,{})]},j.id))}),c.length>0&&e.jsx(b,{sx:{mt:2,textAlign:"center"},children:e.jsx(U,{size:"small",onClick:S,startIcon:e.jsx(se,{}),children:"Xóa tất cả"})})]})})]})})},Is=()=>{const{systemAlerts:t}=Me(),{inventoryAlerts:s}=$e(),[r,n]=o.useState(!1),i=t.length+s.length;return e.jsxs(b,{sx:{position:"relative"},children:[e.jsx(B,{color:"inherit",onClick:()=>n(!r),children:e.jsx(ue,{badgeContent:i,color:"error",max:99,children:e.jsx(pe,{})})}),r&&e.jsx(b,{sx:{position:"absolute",top:"100%",right:0,zIndex:1300,mt:1},children:e.jsx(js,{maxItems:5})})]})};J`
  from {
    transform: translateX(-100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
`;J`
  from {
    transform: translateY(20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
`;const Es=J`
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.05);
  }
`;J`
  0% {
    background-position: -200px 0;
  }
  100% {
    background-position: calc(200px + 100%) 0;
  }
`;const ws=N(Ye)(({theme:t})=>({background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",borderBottom:`1px solid ${g.gray[200]}`,boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",color:g.gray[800],zIndex:t.zIndex.drawer+2,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"})),Ss=N(Qe)(({theme:t})=>({"& .MuiDrawer-paper":{width:de,background:"rgba(248, 250, 252, 0.98)",backdropFilter:"blur(20px)",borderRight:`1px solid ${g.gray[200]}`,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",overflow:"hidden",zIndex:t.zIndex.drawer}}));N(b)(({theme:t})=>({background:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(20px)",borderRadius:20,border:`1px solid ${g.gray[200]}`,boxShadow:P.soft,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateY(-2px)",boxShadow:P.medium}}));const ks=N(b)(({theme:t})=>({position:"relative",borderRadius:12,background:"rgba(248, 250, 252, 0.9)",backdropFilter:"blur(10px)",border:`1px solid ${g.gray[300]}`,"&:hover":{background:"rgba(241, 245, 249, 1)",borderColor:g.primary[400]},"&:focus-within":{background:"rgba(255, 255, 255, 1)",borderColor:g.primary[500],boxShadow:P.colored.primary},marginLeft:t.spacing(2),marginRight:t.spacing(2),width:"100%",maxWidth:400,transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"})),As=N("div")(({theme:t})=>({padding:t.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",color:g.gray[500]})),Cs=N(Xe)(({theme:t})=>({color:g.gray[800],width:"100%","& .MuiInputBase-input":{padding:t.spacing(1.5,1,1.5,0),paddingLeft:`calc(1em + ${t.spacing(4)})`,transition:t.transitions.create("width"),width:"100%",fontSize:"0.875rem",fontWeight:500,"&::placeholder":{color:g.gray[500]}}})),Ps=N(ue)(({theme:t})=>({"& .MuiBadge-badge":{background:"linear-gradient(135deg, #f59e0b 0%, #ef4444 100%)",color:"white",fontWeight:600,fontSize:"0.75rem",animation:`${Es} 2s infinite`}})),Rs=N(Je)(({theme:t})=>({width:40,height:40,background:K.primary,fontWeight:600,fontSize:"1rem",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"scale(1.1)",boxShadow:P.colored.primary}})),we=N(Ae)(({theme:t})=>({borderRadius:12,margin:"4px 12px",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{backgroundColor:g.primary[50],transform:"translateX(4px)"},"&.active":{backgroundColor:g.primary[100],borderLeft:`4px solid ${g.primary[500]}`,"& .MuiListItemIcon-root":{color:g.primary[600]},"& .MuiListItemText-primary":{color:g.primary[700],fontWeight:600}}})),Ts=N(b)(({theme:t})=>({flexGrow:1,padding:t.spacing(3),background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)",minHeight:"100vh",position:"relative","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:`
      radial-gradient(circle at 20% 80%, ${C(g.primary[100],.3)} 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, ${C(g.secondary[100],.3)} 0%, transparent 50%),
      radial-gradient(circle at 40% 40%, ${C(g.success[100],.2)} 0%, transparent 50%)
    `,pointerEvents:"none"}})),Ls=()=>{const t=Ze(),s=it(),r=ct(),{user:n,logout:i}=Ve(),{canAccessMenu:c}=is(),l=et(t.breakpoints.down("md")),[m,x]=o.useState(!l),[f,v]=o.useState(!1),[E,w]=o.useState(null),[_,L]=o.useState(null),S=(p,a)=>{if(a){const M=c(a);return A.getPermissionStatus().loaded&&!M?!1:A.getPermissionStatus().loaded?M:(console.log(`🔄 Permissions not loaded yet, using role-based fallback for: ${a}`),n?.role?p.includes(n.role):!1)}return n?.role?p.includes(n.role):!1},D=[{text:"Dashboard",icon:e.jsx(kt,{}),path:"/dashboard",exact:!0,group:"dashboard",groupLabel:"📊 DASHBOARD",menuKey:"dashboard",roles:["admin","manager","cashier","inventory","sales_agent","affiliate"]},{text:"Điểm bán hàng",icon:e.jsx(ie,{}),path:"/sales/new",group:"sales",groupLabel:"🛒 BÁN HÀNG",menuKey:"sales.pos",roles:["admin","manager","cashier","sales_agent","affiliate"]},{text:"Lịch sử bán hàng",icon:e.jsx(At,{}),path:"/sales",group:"sales",menuKey:"sales.history",roles:["admin","manager","cashier","sales_agent","affiliate"]},{text:"Đơn hàng",icon:e.jsx(Ct,{}),path:"/orders",group:"sales",menuKey:"sales.orders",roles:["admin","manager","cashier","sales_agent","affiliate"]},{text:"Trả hàng",icon:e.jsx(Pt,{}),path:"/returns",group:"sales",menuKey:"sales.returns",roles:["admin","manager","cashier","sales_agent","affiliate"]},{text:"Sản phẩm",icon:e.jsx(_e,{}),path:"/products",group:"inventory",groupLabel:"📦 KHO HÀNG",menuKey:"inventory.products",roles:["admin","manager","inventory","cashier","sales_agent","affiliate"]},{text:"Danh mục",icon:e.jsx(Rt,{}),path:"/categories",group:"inventory",menuKey:"inventory.categories",roles:["admin","manager","inventory","cashier"]},{text:"Nhập kho",icon:e.jsx(_e,{}),path:"/inventory/stock-in",group:"inventory",menuKey:"inventory.stock",roles:["admin","manager","inventory"]},{text:"Nhà cung cấp",icon:e.jsx(Tt,{}),path:"/suppliers",group:"inventory",menuKey:"inventory.suppliers",roles:["admin","manager"]},{text:"Serial Numbers",icon:e.jsx(Lt,{}),path:"/serial-numbers",group:"inventory",menuKey:"inventory.serial",roles:["admin","manager","inventory"]},{text:"PC Builder",icon:e.jsx(Dt,{}),path:"/pc-builder",group:"inventory",menuKey:"inventory.pcbuilder",roles:["admin","manager","cashier","inventory"]},{text:"Bảo hành",icon:e.jsx(Ot,{}),path:"/warranty",group:"inventory",menuKey:"inventory.warranty",roles:["admin","manager","inventory","cashier","sales_agent","affiliate"]},{text:"Khách hàng",icon:e.jsx(zt,{}),path:"/customers",group:"customers",groupLabel:"👥 KHÁCH HÀNG",menuKey:"customers",roles:["admin","manager","cashier","sales_agent","affiliate"]},{text:"Tổng quan",icon:e.jsx(Nt,{}),path:"/reports",group:"reports",groupLabel:"📈 BÁO CÁO",menuKey:"reports.overview",roles:["admin","manager"]},{text:"Doanh thu",icon:e.jsx(Vt,{}),menuKey:"reports.revenue",path:"/reports/revenue",group:"reports",roles:["admin","manager"]},{text:"Tài chính",icon:e.jsx($t,{}),path:"/finance",group:"reports",menuKey:"reports.finance",roles:["admin","manager"]}],O=[{text:"Nhân viên",icon:e.jsx(Te,{}),path:"/employees",group:"admin",groupLabel:"⚙️ QUẢN TRỊ",menuKey:"administration.employees",roles:["admin","manager"]},{text:"Cài đặt",icon:e.jsx(be,{}),path:"/settings",group:"admin",menuKey:"administration.settings",roles:["admin"]}],j=p=>{switch(p){case"dashboard":return C(t.palette.primary.main,.08);case"sales":return C(t.palette.success.main,.08);case"inventory":return C(t.palette.info.main,.08);case"customers":return C(t.palette.secondary.main,.08);case"reports":return C(t.palette.warning.main,.08);case"admin":return C(t.palette.error.main,.08);default:return"transparent"}},V=p=>{w(p.currentTarget)},y=()=>{w(null)},ee=p=>{L(p.currentTarget)},We=()=>{L(null)},Fe=async()=>{await i(),s("/login"),y()},me=p=>{s(p),l&&x(!1)},Ue=()=>{const p=r.pathname;return p==="/"?"Dashboard":p==="/sales/new"?"Điểm bán hàng":p.startsWith("/sales/")?"Chi tiết bán hàng":p==="/sales"?"Lịch sử bán hàng":p==="/products"?"Quản lý sản phẩm":p.startsWith("/products/")?"Chi tiết sản phẩm":p==="/categories"?"Danh mục":p.startsWith("/inventory/")?"Quản lý kho":p==="/customers"?"Khách hàng":p==="/reports"?"Báo cáo":p.startsWith("/reports/")?"Báo cáo & Thống kê":p==="/users"?"Quản lý người dùng":p==="/employees"?"Nhân viên & Hoa hồng":p==="/settings"?"Cài đặt":p==="/finance"?"Tài chính":p==="/accounts"?"Công nợ":p==="/calendar"?"Lịch & Lịch hẹn":p==="/stores"?"Quản lý chi nhánh":p==="/warranty"?"Quản lý bảo hành":"SmartPOS"},$=(p,a=!1)=>a?r.pathname===p:r.pathname.startsWith(p);return e.jsxs(b,{sx:{display:"flex",minHeight:"100vh"},children:[e.jsx(ws,{position:"fixed",children:e.jsxs(te,{sx:{minHeight:70},children:[e.jsx(B,{color:"inherit","aria-label":"toggle drawer",edge:"start",onClick:()=>{l?x(!m):m?(x(!1),v(!0)):(x(!0),v(!1))},sx:{mr:2,minWidth:44,minHeight:44,transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"rotate(180deg)",backgroundColor:C(t.palette.primary.main,.1)}},children:e.jsx(vt,{})}),e.jsx(I,{variant:"h6",noWrap:!0,component:"div",sx:{mr:3,background:K.primary,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",fontWeight:800,fontSize:"1.5rem"},children:"SmartPOS"}),e.jsxs(ks,{children:[e.jsx(As,{children:e.jsx(jt,{})}),e.jsx(Cs,{placeholder:"Tìm kiếm sản phẩm, đơn hàng...",inputProps:{"aria-label":"search"}})]}),e.jsx(b,{sx:{flexGrow:1}}),e.jsx(U,{variant:"contained",sx:{display:{xs:"none",sm:"flex"},mr:2,background:K.success,borderRadius:"12px",padding:"10px 20px",fontWeight:600,textTransform:"none",boxShadow:P.colored.primary,transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateY(-2px)",boxShadow:`${P.colored.primary}, 0 20px 25px -5px rgba(34, 197, 94, 0.3)`}},startIcon:e.jsx(ie,{}),onClick:()=>s("/sales/new"),children:"Bán hàng"}),e.jsx(bs,{}),e.jsx(Is,{}),e.jsx(oe,{title:"Thông báo",children:e.jsx(B,{size:"large",color:"inherit",onClick:ee,sx:{mr:1,minWidth:44,minHeight:44,transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{backgroundColor:C(t.palette.primary.main,.1),transform:"scale(1.1)"}},children:e.jsx(Ps,{badgeContent:3,color:"error",children:e.jsx(pe,{})})})}),e.jsxs(ge,{id:"notification-menu",anchorEl:_,keepMounted:!0,open:!!_,onClose:We,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:320,maxHeight:400}},children:[e.jsx(W,{children:e.jsxs(b,{sx:{width:"100%"},children:[e.jsx(I,{variant:"subtitle2",children:"Sản phẩm sắp hết hàng"}),e.jsx(I,{variant:"body2",color:"text.secondary",children:"5 sản phẩm đang dưới ngưỡng tồn kho"})]})}),e.jsx(F,{}),e.jsx(W,{children:e.jsxs(b,{sx:{width:"100%"},children:[e.jsx(I,{variant:"subtitle2",children:"Đơn hàng mới #1234"}),e.jsx(I,{variant:"body2",color:"text.secondary",children:"Vừa nhận đơn hàng trực tuyến mới"})]})}),e.jsx(F,{}),e.jsx(W,{children:e.jsxs(b,{sx:{width:"100%"},children:[e.jsx(I,{variant:"subtitle2",children:"Nhắc nhở"}),e.jsx(I,{variant:"body2",color:"text.secondary",children:"Cần đồng bộ dữ liệu kho hàng"})]})}),e.jsx(F,{}),e.jsx(W,{onClick:()=>s("/notifications"),children:e.jsx(I,{color:"primary",sx:{width:"100%",textAlign:"center"},children:"Xem tất cả thông báo"})})]}),e.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(oe,{title:`${n?.fullName||"User"}`,children:e.jsx(B,{size:"large",onClick:V,color:"inherit",sx:{ml:1,minWidth:44,minHeight:44},children:e.jsx(Rs,{children:n?.username?.charAt(0).toUpperCase()||"A"})})}),e.jsxs(ge,{id:"menu-appbar",anchorEl:E,keepMounted:!0,open:!!E,onClose:y,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{elevation:2,sx:{width:220}},children:[e.jsx(W,{sx:{pointerEvents:"none"},children:e.jsxs(b,{sx:{width:"100%"},children:[e.jsx(I,{variant:"subtitle2",children:n?.fullName||n?.username}),e.jsx(I,{variant:"caption",color:"text.secondary",children:n?.role?n.role.charAt(0).toUpperCase()+n.role.slice(1):"User"})]})}),e.jsx(F,{}),e.jsxs(W,{onClick:()=>{y(),s("/profile")},children:[e.jsx(H,{children:e.jsx(It,{fontSize:"small"})}),e.jsx(q,{children:"Hồ sơ cá nhân"})]}),e.jsxs(W,{onClick:()=>{y(),s("/settings")},children:[e.jsx(H,{children:e.jsx(be,{fontSize:"small"})}),e.jsx(q,{children:"Cài đặt"})]}),e.jsx(F,{}),e.jsxs(W,{onClick:Fe,children:[e.jsx(H,{children:e.jsx(Et,{fontSize:"small"})}),e.jsx(q,{children:"Đăng xuất"})]})]})]})]})}),e.jsxs(Ss,{variant:l?"temporary":"persistent",anchor:"left",open:m,onClose:()=>x(!1),ModalProps:{keepMounted:!0},sx:{"& .MuiDrawer-paper":{...l&&{zIndex:p=>p.zIndex.drawer}}},children:[e.jsx(te,{}),e.jsxs(b,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",overflowX:"hidden"},children:[e.jsxs(b,{sx:{overflowY:"auto",py:1},children:[e.jsx(ne,{component:"nav",disablePadding:!0,children:(()=>{let p="";return D.filter(a=>!a.roles||S(a.roles,a.menuKey)).map(a=>{const M=a.groupLabel&&a.group!==p;return M&&(p=a.group),e.jsxs(b,{children:[M&&e.jsx(I,{variant:"caption",sx:{display:"block",px:2,py:1,mt:2,mb:1,fontWeight:700,fontSize:"0.75rem",color:t.palette.text.secondary,textTransform:"uppercase",letterSpacing:"0.1em"},children:a.groupLabel}),e.jsx(we,{disablePadding:!0,className:$(a.path,a.exact)?"active":"",sx:{backgroundColor:j(a.group),borderRadius:"8px",margin:"2px 8px","&:hover":{backgroundColor:C(t.palette[a.group==="dashboard"?"primary":a.group==="sales"?"success":a.group==="inventory"?"info":a.group==="customers"?"secondary":a.group==="reports"?"warning":"primary"].main,.12)}},children:e.jsxs(fe,{selected:$(a.path,a.exact),onClick:()=>me(a.path),"data-testid":`nav-${a.text.toLowerCase().replace(/\s+/g,"-")}`,sx:{pl:2,borderRadius:"8px",minHeight:44,"&.Mui-selected":{backgroundColor:C(t.palette[a.group==="dashboard"?"primary":a.group==="sales"?"success":a.group==="inventory"?"info":a.group==="customers"?"secondary":a.group==="reports"?"warning":"primary"].main,.15)}},children:[e.jsx(H,{sx:{color:$(a.path,a.exact)?t.palette[a.group==="dashboard"?"primary":a.group==="sales"?"success":a.group==="inventory"?"info":a.group==="customers"?"secondary":a.group==="reports"?"warning":"primary"].main:t.palette.text.secondary,minWidth:44},children:a.icon}),e.jsx(q,{primary:a.text,primaryTypographyProps:{fontWeight:$(a.path,a.exact)?600:400,fontSize:"0.875rem",color:$(a.path,a.exact)?t.palette[a.group==="dashboard"?"primary":a.group==="sales"?"success":a.group==="inventory"?"info":a.group==="customers"?"secondary":a.group==="reports"?"warning":"primary"].main:t.palette.text.primary}})]})})]},a.text)})})()}),e.jsx(F,{sx:{my:2}}),O.filter(p=>!p.roles||S(p.roles,p.menuKey)).length>0&&e.jsx(ne,{children:(()=>{let p="";return O.filter(a=>!a.roles||S(a.roles,a.menuKey)).map(a=>{const M=a.groupLabel&&a.group!==p;return M&&(p=a.group),e.jsxs(b,{children:[M&&e.jsx(I,{variant:"caption",sx:{display:"block",px:2,py:1,mt:2,mb:1,fontWeight:700,fontSize:"0.75rem",color:t.palette.text.secondary,textTransform:"uppercase",letterSpacing:"0.1em"},children:a.groupLabel}),e.jsx(we,{disablePadding:!0,sx:{backgroundColor:j(a.group),borderRadius:"8px",margin:"2px 8px","&:hover":{backgroundColor:C(t.palette.error.main,.12)}},children:e.jsxs(fe,{selected:$(a.path),onClick:()=>me(a.path),"data-testid":`nav-${a.text.toLowerCase().replace(/\s+/g,"-")}`,sx:{pl:2,borderRadius:"8px",minHeight:44,"&.Mui-selected":{backgroundColor:C(t.palette.error.main,.15)}},children:[e.jsx(H,{sx:{color:$(a.path)?t.palette.error.main:t.palette.text.secondary,minWidth:44},children:a.icon}),e.jsx(q,{primary:a.text,primaryTypographyProps:{fontWeight:$(a.path)?600:400,fontSize:"0.875rem",color:$(a.path)?t.palette.error.main:t.palette.text.primary}})]})})]},a.text)})})()})]}),l&&e.jsx(b,{sx:{p:2},children:e.jsx(U,{variant:"outlined",fullWidth:!0,onClick:()=>x(!1),startIcon:t.direction==="rtl"?e.jsx(wt,{}):e.jsx(St,{}),sx:{minHeight:44,borderRadius:"12px",textTransform:"none",fontWeight:600},children:"Đóng menu"})})]})]}),e.jsxs(Ts,{component:"main",sx:{width:{xs:"100%",md:m?`calc(100% - ${de}px)`:"100%"},marginLeft:{xs:0,md:m?`${de}px`:0},transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),position:"relative"},children:[e.jsx(te,{}),e.jsx(xe,{in:!0,timeout:800,children:e.jsx(I,{variant:"h4",component:"h1",sx:{mb:4,fontWeight:700,background:K.primary,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",position:"relative",zIndex:1},children:Ue()})}),e.jsx(xe,{in:!0,timeout:1e3,children:e.jsx(b,{sx:{position:"relative",zIndex:1},children:e.jsx(lt,{})})})]})]})},T=({children:t,requiredRoles:s=[],fallbackPath:r="/dashboard"})=>{const{isAuthenticated:n,isLoading:i,user:c}=Ve();return console.log("ProtectedRoute: isLoading:",i,"isAuthenticated:",n,"user:",c,"requiredRoles:",s),i?(console.log("ProtectedRoute: Showing loading spinner"),e.jsx(b,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(Ce,{size:60})})):n?s.length>0&&c?.role&&!s.includes(c.role)?(console.log("ProtectedRoute: Insufficient permissions",{userRole:c.role,requiredRoles:s}),e.jsx(b,{p:3,children:e.jsxs(Pe,{severity:"error",children:[e.jsx(I,{variant:"h6",gutterBottom:!0,children:"Không có quyền truy cập"}),e.jsx(I,{children:"Bạn không có quyền truy cập vào trang này. Vui lòng liên hệ quản trị viên để được cấp quyền."}),e.jsxs(I,{variant:"body2",sx:{mt:1},children:["Quyền yêu cầu: ",s.join(", ")]}),e.jsxs(I,{variant:"body2",children:["Quyền hiện tại: ",c.role]})]})})):(console.log("ProtectedRoute: Authenticated with sufficient permissions, rendering children"),e.jsx(e.Fragment,{children:t})):(console.log("ProtectedRoute: Not authenticated, redirecting to login"),e.jsx(ae,{to:"/login",replace:!0}))};var Ds=Object.defineProperty,Os=(t,s,r)=>s in t?Ds(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,G=(t,s,r)=>(Os(t,typeof s!="symbol"?s+"":s,r),r);class zs extends o.Component{constructor(s){super(s),G(this,"reportError",(r,n)=>{try{console.log("📊 Error reported to monitoring service:",this.state.errorId)}catch(i){console.error("Failed to report error:",i)}}),G(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:""})}),G(this,"handleGoHome",()=>{window.location.href="/"}),G(this,"handleReload",()=>{window.location.reload()}),G(this,"handleReportBug",()=>{const r={errorId:this.state.errorId,message:this.state.error?.message,stack:this.state.error?.stack,componentStack:this.state.errorInfo?.componentStack,url:window.location.href,userAgent:navigator.userAgent,timestamp:new Date().toISOString()},n=encodeURIComponent(`Bug Report - Error ID: ${this.state.errorId}`),i=encodeURIComponent(JSON.stringify(r,null,2)),c=`mailto:support@smartpos.com?subject=${n}&body=${i}`;window.open(c,"_blank")}),this.state={hasError:!1,error:null,errorInfo:null,errorId:""}}static getDerivedStateFromError(s){const r=`error_${Date.now()}_${Math.random().toString(36).substring(2,9)}`;return{hasError:!0,error:s,errorId:r}}componentDidCatch(s,r){console.error("🚨 Error Boundary Caught Error:",{error:s.message,stack:s.stack,componentStack:r.componentStack,errorId:this.state.errorId,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href}),this.setState({errorInfo:r}),this.props.onError&&this.props.onError(s,r),this.reportError(s,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx(tt,{maxWidth:"md",sx:{py:4},children:e.jsx(st,{elevation:3,sx:{p:4},children:e.jsxs(Y,{spacing:3,children:[e.jsxs(b,{sx:{textAlign:"center"},children:[e.jsx(Le,{sx:{fontSize:64,color:"error.main",mb:2}}),e.jsx(I,{variant:"h4",component:"h1",gutterBottom:!0,children:"Oops! Đã xảy ra lỗi"}),e.jsx(I,{variant:"body1",color:"text.secondary",children:"Chúng tôi đã ghi nhận lỗi này và đang khắc phục"})]}),e.jsx(F,{}),e.jsxs(Pe,{severity:"error",icon:e.jsx(ve,{}),children:[e.jsx(rt,{children:"Chi tiết lỗi"}),e.jsxs(I,{variant:"body2",component:"div",children:[e.jsx("strong",{children:"Mã lỗi:"})," ",this.state.errorId]}),this.state.error&&e.jsxs(I,{variant:"body2",component:"div",sx:{mt:1},children:[e.jsx("strong",{children:"Thông báo:"})," ",this.state.error.message]})]}),e.jsxs(b,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap"},children:[e.jsx(U,{variant:"contained",startIcon:e.jsx(je,{}),onClick:this.handleRetry,size:"large",children:"Thử lại"}),e.jsx(U,{variant:"outlined",startIcon:e.jsx(Mt,{}),onClick:this.handleGoHome,size:"large",children:"Về trang chủ"}),e.jsx(U,{variant:"outlined",startIcon:e.jsx(je,{}),onClick:this.handleReload,size:"large",children:"Tải lại trang"}),e.jsx(U,{variant:"outlined",startIcon:e.jsx(ve,{}),onClick:this.handleReportBug,size:"large",children:"Báo cáo lỗi"})]}),!1]})})}):this.props.children}}const Ns=o.lazy(()=>u(()=>import("../pages/Login-9db52e90.js"),["pages/Login-9db52e90.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/utils-vendor-8faa4a85.js"])),Vs=o.lazy(()=>u(()=>import("../pages/Register-ef6c79e8.js"),["pages/Register-ef6c79e8.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/utils-vendor-8faa4a85.js"])),$s=o.lazy(()=>u(()=>import("../pages/Dashboard-d05490e1.js"),["pages/Dashboard-d05490e1.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/ui-vendor-11834b8a.js","chunks/utils-vendor-8faa4a85.js"])),Ms=o.lazy(()=>u(()=>import("../pages/ProductList-66ebbbc9.js"),["pages/ProductList-66ebbbc9.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/ui-vendor-11834b8a.js"]));o.lazy(()=>u(()=>import("../pages/SimpleProductDetail-341b08ac.js"),["pages/SimpleProductDetail-341b08ac.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"]));const Ws=o.lazy(()=>u(()=>import("../pages/ProductDetailReal-7518aaa0.js"),["pages/ProductDetailReal-7518aaa0.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"]));o.lazy(()=>u(()=>import("../pages/ProductDetailWorking-0c85acc0.js"),["pages/ProductDetailWorking-0c85acc0.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"]));const Fs=o.lazy(()=>u(()=>import("../pages/TestProductDetail-05f01974.js"),["pages/TestProductDetail-05f01974.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"])),Us=o.lazy(()=>u(()=>import("../pages/ProductEdit-9c832520.js"),["pages/ProductEdit-9c832520.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/ui-vendor-11834b8a.js"])),Bs=o.lazy(()=>u(()=>import("../pages/Categories-484a65b1.js"),["pages/Categories-484a65b1.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),Hs=o.lazy(()=>u(()=>import("../pages/Sales-ea54791f.js"),["pages/Sales-ea54791f.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),qs=o.lazy(()=>u(()=>import("../pages/NewSaleSimple-f5a2b656.js"),["pages/NewSaleSimple-f5a2b656.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/utils-vendor-8faa4a85.js"])),Ks=o.lazy(()=>u(()=>import("../pages/SaleDetail-9c0e5f01.js"),["pages/SaleDetail-9c0e5f01.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/utils-vendor-8faa4a85.js"])),Gs=o.lazy(()=>u(()=>import("../pages/Orders-2ef88ff8.js"),["pages/Orders-2ef88ff8.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),Ys=o.lazy(()=>u(()=>import("../pages/Returns-60182a63.js"),["pages/Returns-60182a63.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),Qs=o.lazy(()=>u(()=>import("../pages/CreateReturn-60460f74.js"),["pages/CreateReturn-60460f74.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/utils-vendor-8faa4a85.js"])),Xs=o.lazy(()=>u(()=>import("../pages/Promotions-fec311af.js"),["pages/Promotions-fec311af.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/utils-vendor-8faa4a85.js"])),Js=o.lazy(()=>u(()=>import("../pages/Inventory-13a4ea72.js"),["pages/Inventory-13a4ea72.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/ui-vendor-11834b8a.js","chunks/utils-vendor-8faa4a85.js"])),Zs=o.lazy(()=>u(()=>import("../pages/InventoryTransactions-a958461e.js"),["pages/InventoryTransactions-a958461e.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),er=o.lazy(()=>u(()=>import("../pages/StockInNew-702f535a.js"),["pages/StockInNew-702f535a.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),tr=o.lazy(()=>u(()=>import("../pages/StockTransfer-f595b6e6.js"),["pages/StockTransfer-f595b6e6.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),sr=o.lazy(()=>u(()=>import("../pages/StockCheck-1e28fb0c.js"),["pages/StockCheck-1e28fb0c.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),rr=o.lazy(()=>u(()=>import("../pages/SupplierTest-6fd05627.js"),["pages/SupplierTest-6fd05627.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/query-vendor-0e167262.js","chunks/ui-vendor-11834b8a.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js"])),or=o.lazy(()=>u(()=>import("../pages/EnhancedFeatures-46fa73ef.js"),["pages/EnhancedFeatures-46fa73ef.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js","chunks/chart-vendor-c17345c1.js"])),nr=o.lazy(()=>u(()=>import("../pages/FinancePage-a9f699fa.js"),["pages/FinancePage-a9f699fa.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js","chunks/chart-vendor-c17345c1.js","chunks/query-vendor-0e167262.js","chunks/ui-vendor-11834b8a.js","chunks/utils-vendor-8faa4a85.js"])),ar=o.lazy(()=>u(()=>import("../pages/SmartReportsDemo-043c2778.js"),["pages/SmartReportsDemo-043c2778.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"])),ir=o.lazy(()=>u(()=>import("../pages/SerialNumberManagement-04e9d99f.js"),["pages/SerialNumberManagement-04e9d99f.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/utils-vendor-8faa4a85.js"])),Se=o.lazy(()=>u(()=>import("../pages/WarrantyManagement-5782e3fc.js"),["pages/WarrantyManagement-5782e3fc.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/ui-vendor-11834b8a.js","chunks/utils-vendor-8faa4a85.js"])),cr=o.lazy(()=>u(()=>import("../pages/SuppliersPage-70bc305b.js"),["pages/SuppliersPage-70bc305b.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),lr=o.lazy(()=>u(()=>import("../pages/Reports-e58130ed.js"),["pages/Reports-e58130ed.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-data-a0a8b8a4.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/chart-vendor-c17345c1.js","chunks/query-vendor-0e167262.js","chunks/ui-vendor-11834b8a.js"])),ke=o.lazy(()=>u(()=>import("../pages/RevenueReport-a2ae7510.js"),["pages/RevenueReport-a2ae7510.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js","chunks/chart-vendor-c17345c1.js","chunks/query-vendor-0e167262.js","chunks/ui-vendor-11834b8a.js","chunks/utils-vendor-8faa4a85.js"])),dr=o.lazy(()=>u(()=>import("../pages/TopProductsReport-355b65ef.js"),["pages/TopProductsReport-355b65ef.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"])),ur=o.lazy(()=>u(()=>import("../pages/InventoryReport-d8e61663.js"),["pages/InventoryReport-d8e61663.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"])),pr=o.lazy(()=>u(()=>import("../pages/ProfitReport-7d6b0a50.js"),["pages/ProfitReport-7d6b0a50.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"])),hr=o.lazy(()=>u(()=>import("../pages/Customers-a356e6fc.js"),["pages/Customers-a356e6fc.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),mr=o.lazy(()=>u(()=>import("../pages/CustomerDetail-d5b93ab3.js"),["pages/CustomerDetail-d5b93ab3.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/utils-vendor-8faa4a85.js"])),gr=o.lazy(()=>u(()=>import("../pages/Finance-797b6b6a.js"),["pages/Finance-797b6b6a.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/chart-vendor-c17345c1.js","chunks/query-vendor-0e167262.js","chunks/utils-vendor-8faa4a85.js"])),fr=o.lazy(()=>u(()=>import("../pages/Accounts-22abca24.js"),["pages/Accounts-22abca24.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"])),xr=o.lazy(()=>u(()=>import("../pages/Users-6e68cdbc.js"),["pages/Users-6e68cdbc.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),yr=o.lazy(()=>u(()=>import("../pages/EmployeeCommission-913b7334.js"),["pages/EmployeeCommission-913b7334.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js"])),br=o.lazy(()=>u(()=>import("../pages/Settings-92df3197.js"),["pages/Settings-92df3197.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"])),_r=o.lazy(()=>u(()=>import("../pages/Calendar-655f73de.js"),["pages/Calendar-655f73de.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"])),vr=o.lazy(()=>u(()=>import("../pages/Stores-72d50c59.js"),["pages/Stores-72d50c59.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/useApiData-60d9f817.js","chunks/utils-vendor-8faa4a85.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/ui-vendor-11834b8a.js"])),jr=o.lazy(()=>u(()=>import("../pages/Profile-f7a4eed0.js"),["pages/Profile-f7a4eed0.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js"])),Ir=o.lazy(()=>u(()=>import("../pages/PCBuilder-d5e39378.js"),["pages/PCBuilder-d5e39378.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/ui-vendor-11834b8a.js","chunks/mui-icons-f0327ae6.js","chunks/query-vendor-0e167262.js","chunks/utils-vendor-8faa4a85.js"])),Er=o.lazy(()=>u(()=>import("../pages/NotFound-fe1ef821.js"),["pages/NotFound-fe1ef821.js","chunks/mui-core-cd9e8750.js","chunks/react-vendor-9ee90314.js","chunks/mui-icons-f0327ae6.js"])),wr=()=>e.jsx(b,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#fafafa"},children:e.jsx(Ce,{size:60})});function Sr(){return e.jsx(zs,{children:e.jsx(cs,{children:e.jsx(o.Suspense,{fallback:e.jsx(wr,{}),children:e.jsxs(dt,{children:[e.jsx(d,{path:"/login",element:e.jsx(Ns,{})}),e.jsx(d,{path:"/register",element:e.jsx(Vs,{})}),e.jsx(d,{path:"/",element:e.jsx(ae,{to:"/login",replace:!0})}),e.jsxs(d,{element:e.jsx(T,{children:e.jsx(Ls,{})}),children:[e.jsx(d,{path:"/dashboard",element:e.jsx($s,{})}),e.jsx(d,{path:"/products",element:e.jsx(Ms,{})}),e.jsx(d,{path:"/products/:id/edit",element:e.jsx(Us,{})}),e.jsx(d,{path:"/products/:id",element:e.jsx(Ws,{})}),e.jsx(d,{path:"/test-products/:id",element:e.jsx(Fs,{})}),e.jsx(d,{path:"/categories",element:e.jsx(Bs,{})}),e.jsx(d,{path:"/inventory",element:e.jsx(Js,{})}),e.jsx(d,{path:"/inventory/transactions",element:e.jsx(Zs,{})}),e.jsx(d,{path:"/inventory/stock-in",element:e.jsx(er,{})}),e.jsx(d,{path:"/inventory/transfer",element:e.jsx(tr,{})}),e.jsx(d,{path:"/inventory/check",element:e.jsx(sr,{})}),e.jsx(d,{path:"/inventory/supplier-test",element:e.jsx(rr,{})}),e.jsx(d,{path:"/enhanced-features",element:e.jsx(or,{})}),e.jsx(d,{path:"/reports/revenue",element:e.jsx(ke,{})}),e.jsx(d,{path:"/finance",element:e.jsx(nr,{})}),e.jsx(d,{path:"/smart-reports",element:e.jsx(ar,{})}),e.jsx(d,{path:"/serial-numbers",element:e.jsx(ir,{})}),e.jsx(d,{path:"/warranty",element:e.jsx(Se,{})}),e.jsx(d,{path:"/suppliers",element:e.jsx(cr,{})}),e.jsx(d,{path:"/sales/new",element:e.jsx(qs,{})}),e.jsx(d,{path:"/sales/:id",element:e.jsx(Ks,{})}),e.jsx(d,{path:"/sales",element:e.jsx(Hs,{})}),e.jsx(d,{path:"/orders",element:e.jsx(Gs,{})}),e.jsx(d,{path:"/returns/new",element:e.jsx(Qs,{})}),e.jsx(d,{path:"/returns",element:e.jsx(Ys,{})}),e.jsx(d,{path:"/promotions",element:e.jsx(Xs,{})}),e.jsx(d,{path:"/customers",element:e.jsx(hr,{})}),e.jsx(d,{path:"/customers/:id",element:e.jsx(mr,{})}),e.jsx(d,{path:"/reports",element:e.jsx(T,{requiredRoles:["admin","manager"],children:e.jsx(lr,{})})}),e.jsx(d,{path:"/reports/revenue",element:e.jsx(T,{requiredRoles:["admin","manager"],children:e.jsx(ke,{})})}),e.jsx(d,{path:"/reports/top-products",element:e.jsx(T,{requiredRoles:["admin","manager"],children:e.jsx(dr,{})})}),e.jsx(d,{path:"/reports/inventory",element:e.jsx(T,{requiredRoles:["admin","manager"],children:e.jsx(ur,{})})}),e.jsx(d,{path:"/reports/profit",element:e.jsx(T,{requiredRoles:["admin","manager"],children:e.jsx(pr,{})})}),e.jsx(d,{path:"/finance",element:e.jsx(T,{requiredRoles:["admin","manager"],children:e.jsx(gr,{})})}),e.jsx(d,{path:"/accounts",element:e.jsx(T,{requiredRoles:["admin","manager"],children:e.jsx(fr,{})})}),e.jsx(d,{path:"/calendar",element:e.jsx(_r,{})}),e.jsx(d,{path:"/stores",element:e.jsx(vr,{})}),e.jsx(d,{path:"/profile",element:e.jsx(jr,{})}),e.jsx(d,{path:"/pc-builder",element:e.jsx(Ir,{})})," ",e.jsx(d,{path:"/warranty",element:e.jsx(Se,{})}),e.jsx(d,{path:"/users",element:e.jsx(T,{requiredRoles:["admin"],children:e.jsx(xr,{})})}),e.jsx(d,{path:"/employees",element:e.jsx(T,{requiredRoles:["admin","manager"],children:e.jsx(yr,{})})}),e.jsx(d,{path:"/settings",element:e.jsx(T,{requiredRoles:["admin"],children:e.jsx(br,{})})})]}),e.jsx(d,{path:"/404",element:e.jsx(Er,{})}),e.jsx(d,{path:"*",element:e.jsx(ae,{replace:!0,to:"/404"})})]})})})})}const kr=new pt({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnMount:!1,refetchOnReconnect:"always",networkMode:"online"},mutations:{retry:1,networkMode:"online"}}});"serviceWorker"in navigator&&(navigator.serviceWorker.getRegistrations().then(function(t){console.log("🔧 Found",t.length,"service worker registrations");for(let s of t)s.unregister().then(function(r){console.log("🗑️ ServiceWorker unregistered:",r,s.scope)})}),"caches"in window&&caches.keys().then(function(t){console.log("🧹 Found",t.length,"caches to delete");for(let s of t)caches.delete(s).then(function(r){console.log("🗑️ Cache deleted:",s,r)})}),navigator.serviceWorker.register=function(){return console.log("🚫 ServiceWorker registration blocked"),Promise.reject(new Error("ServiceWorker registration disabled"))});ce.createRoot(document.getElementById("root")).render(e.jsx(Re.StrictMode,{children:e.jsx(ut,{children:e.jsx(ht,{client:kr,children:e.jsxs(ot,{theme:us,children:[e.jsx(nt,{}),e.jsx(Sr,{}),e.jsx(mt,{position:"top-right"})]})})})}));export{Bt as A,h as a,Dr as b,g as c,Or as d,zr as e,_s as f,K as g,k as r,P as s,Ve as u};
