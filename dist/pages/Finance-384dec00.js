import{u as e,g as s,j as n,B as i,C as r,E as t,x as a,J as c,i as l,l as h,G as o,K as d,N as x,Q as j,R as m,y as u,W as g,X as p,Y as y,n as v,Z as f,_ as b,$ as S,a0 as C,a1 as w,a2 as T,O as P,a4 as B,a5 as I,a6 as k,a7 as L,a9 as K}from"../chunks/mui-core-c8a509c2.js";import{r as D}from"../chunks/react-vendor-546521e5.js";import{j as F,p as z,aq as W,w as E,r as N,q as R,T as $,S as q}from"../chunks/mui-icons-38bddb39.js";import{R as H,L as V,C as X,X as A,Y as G,T as O,d as Q,P as Y,b as J,c as M,B as Z,e as _}from"../chunks/chart-vendor-8aa27638.js";const U=()=>{const U=e(),ee=s(U.breakpoints.down("md")),[se,ne]=D.useState([]),[ie,re]=D.useState(!0),[te,ae]=D.useState(0),[ce,le]=D.useState(10),[he,oe]=D.useState(0),[de,xe]=D.useState(""),[je,me]=D.useState("all");D.useState(null),D.useState(null);const[ue,ge]=D.useState(!1),[pe,ye]=D.useState("income"),[ve,fe]=D.useState({totalIncome:0,totalExpense:0,netProfit:0,balance:0}),be=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"];D.useEffect(()=>{Se()},[]);const Se=async()=>{try{re(!0),ne([]),fe({totalIncome:0,totalExpense:0,netProfit:0,balance:0})}catch(e){}finally{re(!1)}},Ce=()=>{ge(!1)},we=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),Te=se.filter(e=>{const s=e.description.toLowerCase().includes(de.toLowerCase())||e.reference?.toLowerCase().includes(de.toLowerCase()),n="all"===je||e.type===je;return s&&n}),Pe=Te.slice(te*ce,te*ce+ce);return ie?n.jsx(i,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:n.jsx(r,{})}):n.jsxs(t,{maxWidth:"xl",sx:{py:{xs:1,sm:2},px:{xs:1,sm:2,md:3},minHeight:"100vh",bgcolor:"grey.50"},children:[n.jsx(a,{elevation:1,sx:{p:{xs:2,sm:3},mb:3,borderRadius:2,bgcolor:"white"},children:n.jsxs(c,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},spacing:2,children:[n.jsxs(i,{children:[n.jsxs(l,{variant:"h4",sx:{display:"flex",alignItems:"center",gap:1,fontSize:{xs:"1.5rem",sm:"2rem",md:"2.125rem"},fontWeight:600,color:"primary.main",mb:1},children:[n.jsx(F,{sx:{fontSize:"inherit"}}),"Quản lý tài chính"]}),n.jsx(l,{variant:"body1",color:"text.secondary",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:"Theo dõi doanh thu, chi phí và báo cáo tài chính"})]}),n.jsxs(c,{direction:"row",spacing:1,children:[n.jsx(h,{variant:"outlined",startIcon:n.jsx(z,{}),onClick:Se,size:ee?"small":"medium",children:"Làm mới"}),n.jsx(h,{variant:"outlined",startIcon:n.jsx(W,{}),size:ee?"small":"medium",children:"Xuất báo cáo"}),n.jsx(h,{variant:"contained",startIcon:n.jsx(E,{}),onClick:()=>(ye("income"),void ge(!0)),size:ee?"small":"medium",children:"Thêm giao dịch"})]})]})}),n.jsxs(o,{container:!0,spacing:3,mb:3,children:[n.jsx(o,{item:!0,xs:12,sm:6,md:3,children:n.jsx(d,{children:n.jsx(x,{children:n.jsxs(i,{display:"flex",alignItems:"center",children:[n.jsx(N,{color:"success",sx:{mr:2}}),n.jsxs(i,{children:[n.jsx(l,{color:"textSecondary",gutterBottom:!0,children:"Tổng thu"}),n.jsx(l,{variant:"h5",children:we(ve.totalIncome)})]})]})})})}),n.jsx(o,{item:!0,xs:12,sm:6,md:3,children:n.jsx(d,{children:n.jsx(x,{children:n.jsxs(i,{display:"flex",alignItems:"center",children:[n.jsx(R,{color:"error",sx:{mr:2}}),n.jsxs(i,{children:[n.jsx(l,{color:"textSecondary",gutterBottom:!0,children:"Tổng chi"}),n.jsx(l,{variant:"h5",children:we(ve.totalExpense)})]})]})})})}),n.jsx(o,{item:!0,xs:12,sm:6,md:3,children:n.jsx(d,{children:n.jsx(x,{children:n.jsxs(i,{display:"flex",alignItems:"center",children:[n.jsx($,{color:"primary",sx:{mr:2}}),n.jsxs(i,{children:[n.jsx(l,{color:"textSecondary",gutterBottom:!0,children:"Lợi nhuận"}),n.jsx(l,{variant:"h5",color:ve.netProfit>=0?"success.main":"error.main",children:we(ve.netProfit)})]})]})})})}),n.jsx(o,{item:!0,xs:12,sm:6,md:3,children:n.jsx(d,{children:n.jsx(x,{children:n.jsxs(i,{display:"flex",alignItems:"center",children:[n.jsx(F,{color:"info",sx:{mr:2}}),n.jsxs(i,{children:[n.jsx(l,{color:"textSecondary",gutterBottom:!0,children:"Số dư"}),n.jsx(l,{variant:"h5",children:we(ve.balance)})]})]})})})})]}),n.jsx(i,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:n.jsxs(j,{value:he,onChange:(e,s)=>{oe(s)},children:[n.jsx(m,{label:"Tổng quan"}),n.jsx(m,{label:"Giao dịch"}),n.jsx(m,{label:"Báo cáo"})]})}),0===he&&n.jsxs(o,{container:!0,spacing:3,children:[n.jsx(o,{item:!0,xs:12,md:8,children:n.jsx(d,{children:n.jsxs(x,{children:[n.jsx(l,{variant:"h6",gutterBottom:!0,children:"Biểu đồ thu chi"}),n.jsx(i,{height:300,children:n.jsx(H,{width:"100%",height:"100%",children:n.jsxs(V,{data:[],children:[n.jsx(X,{strokeDasharray:"3 3"}),n.jsx(A,{dataKey:"name"}),n.jsx(G,{}),n.jsx(O,{}),n.jsx(Q,{type:"monotone",dataKey:"income",stroke:"#8884d8",name:"Thu"}),n.jsx(Q,{type:"monotone",dataKey:"expense",stroke:"#82ca9d",name:"Chi"})]})})})]})})}),n.jsx(o,{item:!0,xs:12,md:4,children:n.jsx(d,{children:n.jsxs(x,{children:[n.jsx(l,{variant:"h6",gutterBottom:!0,children:"Phân bổ chi tiêu"}),n.jsx(i,{height:300,children:n.jsx(H,{width:"100%",height:"100%",children:n.jsxs(Y,{children:[n.jsx(J,{data:[],cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:s})=>`${e} ${(100*s).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:[].map((e,s)=>n.jsx(M,{fill:be[s%be.length]},`cell-${s}`))}),n.jsx(O,{})]})})})]})})})]}),1===he&&n.jsx(d,{children:n.jsxs(x,{children:[n.jsxs(i,{display:"flex",gap:2,mb:3,children:[n.jsx(u,{placeholder:"Tìm kiếm giao dịch...",value:de,onChange:e=>{xe(e.target.value)},InputProps:{startAdornment:n.jsx(q,{})},sx:{minWidth:300}}),n.jsxs(g,{sx:{minWidth:150},children:[n.jsx(p,{children:"Loại giao dịch"}),n.jsxs(y,{value:je,onChange:e=>{me(e.target.value)},label:"Loại giao dịch",children:[n.jsx(v,{value:"all",children:"Tất cả"}),n.jsx(v,{value:"income",children:"Thu"}),n.jsx(v,{value:"expense",children:"Chi"})]})]})]}),n.jsx(f,{children:n.jsxs(b,{children:[n.jsx(S,{children:n.jsxs(C,{children:[n.jsx(w,{children:"Ngày"}),n.jsx(w,{children:"Mô tả"}),n.jsx(w,{children:"Loại"}),n.jsx(w,{children:"Số tiền"}),n.jsx(w,{children:"Danh mục"}),n.jsx(w,{children:"Phương thức"}),n.jsx(w,{children:"Tham chiếu"})]})}),n.jsx(T,{children:0===Pe.length?n.jsx(C,{children:n.jsx(w,{colSpan:7,align:"center",children:n.jsx(l,{variant:"body2",color:"textSecondary",children:"Không có giao dịch nào"})})}):Pe.map(e=>{return n.jsxs(C,{children:[n.jsx(w,{children:(s=e.date,new Date(s).toLocaleDateString("vi-VN"))}),n.jsx(w,{children:e.description}),n.jsx(w,{children:n.jsx(P,{label:"income"===e.type?"Thu":"Chi",color:"income"===e.type?"success":"error",size:"small"})}),n.jsx(w,{children:we(e.amount)}),n.jsx(w,{children:e.category}),n.jsx(w,{children:e.method}),n.jsx(w,{children:e.reference})]},e.id);var s})})]})}),n.jsx(B,{rowsPerPageOptions:[5,10,25],component:"div",count:Te.length,rowsPerPage:ce,page:te,onPageChange:(e,s)=>{ae(s)},onRowsPerPageChange:e=>{le(parseInt(e.target.value,10)),ae(0)},labelRowsPerPage:"Số dòng mỗi trang:"})]})}),2===he&&n.jsxs(o,{container:!0,spacing:3,children:[n.jsx(o,{item:!0,xs:12,md:6,children:n.jsx(d,{children:n.jsxs(x,{children:[n.jsx(l,{variant:"h6",gutterBottom:!0,children:"Thu chi theo tháng"}),n.jsx(i,{height:300,children:n.jsx(H,{width:"100%",height:"100%",children:n.jsxs(Z,{data:[],children:[n.jsx(X,{strokeDasharray:"3 3"}),n.jsx(A,{dataKey:"name"}),n.jsx(G,{}),n.jsx(O,{}),n.jsx(_,{dataKey:"income",fill:"#8884d8",name:"Thu"}),n.jsx(_,{dataKey:"expense",fill:"#82ca9d",name:"Chi"})]})})})]})})}),n.jsx(o,{item:!0,xs:12,md:6,children:n.jsx(d,{children:n.jsxs(x,{children:[n.jsx(l,{variant:"h6",gutterBottom:!0,children:"Thống kê chi tiết"}),n.jsx(i,{children:n.jsx(l,{variant:"body2",color:"textSecondary",children:"Báo cáo chi tiết sẽ được hiển thị ở đây"})})]})})})]}),n.jsxs(I,{open:ue,onClose:Ce,maxWidth:"sm",fullWidth:!0,children:[n.jsxs(k,{children:["Thêm giao dịch ","income"===pe?"thu":"chi"]}),n.jsx(L,{children:n.jsx(l,{variant:"body2",color:"textSecondary",children:"Tính năng thêm giao dịch đang được phát triển..."})}),n.jsxs(K,{children:[n.jsx(h,{onClick:Ce,children:"Hủy"}),n.jsx(h,{variant:"contained",onClick:Ce,children:"Lưu"})]})]})]})};export{U as default};
