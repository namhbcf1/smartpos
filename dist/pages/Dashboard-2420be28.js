import{u as e,g as s,j as t,E as n,x as i,S as r,G as a,i as l,H as c,l as o,J as d,B as x,K as h,N as m,e as j,o as y,O as p,Q as u,R as g,y as f,z as b,h as v,r as k,L as C,U as w,q as I,V as S}from"../chunks/mui-core-c8a509c2.js";import{u as z,r as W}from"../chunks/react-vendor-546521e5.js";import{u as _,f as K,a as R}from"../assets/index-e3f8a988.js";import{p as q,F as P,T,q as B,r as D,s as A,h as F,I as L,t as N,m as O,u as X,v as $,w as G,j as H}from"../chunks/mui-icons-38bddb39.js";import{R as V,A as Q,C as E,X as J,Y as M,T as U,a as Y,P as Z,b as ee,c as se}from"../chunks/chart-vendor-8aa27638.js";import"../chunks/query-vendor-a9f5ea8b.js";import"../chunks/ui-vendor-6aa703b7.js";import"../chunks/utils-vendor-11713830.js";const te=()=>{const te=z(),ne=e(),ie=s(ne.breakpoints.down("md")),{user:re}=_(),[ae,le]=W.useState(null),[ce,oe]=W.useState([]),[de,xe]=W.useState([]),[he,me]=W.useState(!0),[je,ye]=W.useState(null),[pe,ue]=W.useState(0),[ge,fe]=W.useState("week"),be=[ne.palette.primary.main,ne.palette.secondary.main,ne.palette.success.main,ne.palette.warning.main,ne.palette.error.main,ne.palette.info.main];W.useEffect(()=>{(async()=>{try{me(!0);const e=await R.get("/reports/dashboard");le(e);const s=await R.get("/sales?limit=5");oe(s);const t=await R.get("/products?status=active&low_stock=true&limit=5");xe(t),me(!1)}catch(e){ye("Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu dashboard. Vui l√≤ng th·ª≠ l·∫°i sau."),me(!1)}})()},[ge]);const ve=e=>{fe(e)};return he?t.jsxs(n,{maxWidth:"xl",sx:{py:{xs:1,sm:2},px:{xs:1,sm:2,md:3},minHeight:"100vh",bgcolor:"grey.50"},children:[t.jsxs(i,{sx:{p:3,mb:3,borderRadius:2},children:[t.jsx(r,{variant:"text",width:"40%",height:40}),t.jsx(r,{variant:"text",width:"60%",height:20})]}),t.jsxs(a,{container:!0,spacing:3,children:[[1,2,3,4].map(e=>t.jsx(a,{item:!0,xs:12,sm:6,md:3,children:t.jsx(i,{sx:{p:2,borderRadius:2},children:t.jsx(r,{variant:"rectangular",height:120})})},e)),t.jsx(a,{item:!0,xs:12,md:8,children:t.jsx(i,{sx:{p:2,borderRadius:2},children:t.jsx(r,{variant:"rectangular",height:300})})}),t.jsx(a,{item:!0,xs:12,md:4,children:t.jsx(i,{sx:{p:2,borderRadius:2},children:t.jsx(r,{variant:"rectangular",height:300})})})]})]}):je?t.jsx(n,{maxWidth:"xl",sx:{py:{xs:1,sm:2},px:{xs:1,sm:2,md:3},minHeight:"100vh",bgcolor:"grey.50"},children:t.jsxs(i,{sx:{p:3,borderRadius:2},children:[t.jsx(l,{variant:"h4",gutterBottom:!0,children:"Dashboard"}),t.jsx(c,{severity:"error",sx:{mb:2},children:je}),t.jsx(o,{variant:"contained",onClick:()=>window.location.reload(),startIcon:t.jsx(q,{}),children:"T·∫£i l·∫°i d·ªØ li·ªáu"})]})}):t.jsxs(n,{maxWidth:"xl",sx:{py:{xs:1,sm:2},px:{xs:1,sm:2,md:3},minHeight:"100vh",bgcolor:"grey.50"},children:[t.jsx(i,{elevation:1,sx:{p:{xs:2,sm:3},mb:3,borderRadius:2,bgcolor:"white"},children:t.jsxs(d,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},spacing:2,children:[t.jsxs(x,{children:[t.jsxs(l,{variant:"h4",sx:{fontSize:{xs:"1.5rem",sm:"2rem",md:"2.125rem"},fontWeight:600,color:"primary.main",mb:1},children:["Xin ch√†o, ",re?.fullName||re?.username,"! üëã"]}),t.jsxs(l,{variant:"body1",color:"text.secondary",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:["Th·ªëng k√™ t·ªïng quan - ",(new Date).toLocaleDateString("vi-VN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),t.jsxs(d,{direction:"row",spacing:1,children:[t.jsx(o,{variant:"outlined",startIcon:t.jsx(P,{}),size:ie?"small":"medium",children:"B·ªô l·ªçc"}),t.jsx(o,{variant:"contained",startIcon:t.jsx(q,{}),onClick:()=>window.location.reload(),size:ie?"small":"medium",children:"L√†m m·ªõi"})]})]})}),t.jsxs(a,{container:!0,spacing:3,sx:{mb:3},children:[t.jsx(a,{item:!0,xs:12,sm:6,md:3,children:t.jsx(h,{raised:!0,children:t.jsxs(m,{children:[t.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[t.jsxs(x,{children:[t.jsx(l,{variant:"overline",color:"text.secondary",children:"Doanh thu h√¥m nay"}),t.jsx(l,{variant:"h5",sx:{my:.5,fontWeight:600},children:ae?K(ae.todaySales):"0 ‚Ç´"}),t.jsx(x,{sx:{display:"flex",alignItems:"center"},children:ae&&ae.trendPercent>0?t.jsxs(t.Fragment,{children:[t.jsx(T,{sx:{color:"success.main",fontSize:16,mr:.5}}),t.jsxs(l,{variant:"body2",color:"success.main",children:["+",ae.trendPercent,"% so v·ªõi h√¥m qua"]})]}):t.jsxs(t.Fragment,{children:[t.jsx(B,{sx:{color:"error.main",fontSize:16,mr:.5}}),t.jsxs(l,{variant:"body2",color:"error.main",children:[ae?.trendPercent,"% so v·ªõi h√¥m qua"]})]})})]}),t.jsx(j,{sx:{bgcolor:"primary.main",width:56,height:56},children:t.jsx(D,{})})]}),t.jsx(y,{}),t.jsxs(x,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:2},children:[t.jsxs(l,{variant:"body2",color:"text.secondary",children:[ae?.todayOrders||0," ƒë∆°n h√†ng"]}),t.jsx(o,{size:"small",endIcon:t.jsx(A,{fontSize:"small"}),onClick:()=>te("/sales"),children:"Chi ti·∫øt"})]})]})})}),t.jsx(a,{item:!0,xs:12,sm:6,md:3,children:t.jsx(h,{raised:!0,children:t.jsxs(m,{children:[t.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[t.jsxs(x,{children:[t.jsx(l,{variant:"overline",color:"text.secondary",children:"Doanh thu tu·∫ßn"}),t.jsx(l,{variant:"h5",sx:{my:.5,fontWeight:600},children:ae?K(ae.weekSales):"0 ‚Ç´"}),t.jsx(x,{sx:{display:"flex",alignItems:"center"},children:t.jsxs(l,{variant:"body2",color:"text.secondary",children:[ae?.weekOrders||0," ƒë∆°n h√†ng"]})})]}),t.jsx(j,{sx:{bgcolor:"secondary.main",width:56,height:56},children:t.jsx(F,{})})]}),t.jsx(y,{}),t.jsxs(x,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:2},children:[t.jsxs(l,{variant:"body2",color:"text.secondary",children:[ae?.pendingOrders||0," ƒë∆°n ch·ªù x·ª≠ l√Ω"]}),t.jsx(o,{size:"small",endIcon:t.jsx(A,{fontSize:"small"}),onClick:()=>te("/reports/revenue"),children:"Xem b√°o c√°o"})]})]})})}),t.jsx(a,{item:!0,xs:12,sm:6,md:3,children:t.jsx(h,{raised:!0,children:t.jsxs(m,{children:[t.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[t.jsxs(x,{children:[t.jsx(l,{variant:"overline",color:"text.secondary",children:"S·∫£n ph·∫©m"}),t.jsx(l,{variant:"h5",sx:{my:.5,fontWeight:600},children:ae?.productCount||0}),t.jsx(x,{sx:{display:"flex",alignItems:"center"},children:t.jsxs(l,{variant:"body2",color:"text.secondary",children:["trong ",ae?.categoryCount||0," danh m·ª•c"]})})]}),t.jsx(j,{sx:{bgcolor:"success.main",width:56,height:56},children:t.jsx(L,{})})]}),t.jsx(y,{}),t.jsxs(x,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:2},children:[t.jsxs(l,{variant:"body2",color:"error.main",sx:{display:"flex",alignItems:"center"},children:[t.jsx(N,{fontSize:"small",sx:{mr:.5}}),ae?.lowStockCount||0," s·∫£n ph·∫©m s·∫Øp h·∫øt"]}),t.jsx(o,{size:"small",endIcon:t.jsx(A,{fontSize:"small"}),onClick:()=>te("/products"),children:"Qu·∫£n l√Ω"})]})]})})}),t.jsx(a,{item:!0,xs:12,sm:6,md:3,children:t.jsx(h,{raised:!0,children:t.jsxs(m,{children:[t.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[t.jsxs(x,{children:[t.jsx(l,{variant:"overline",color:"text.secondary",children:"Kh√°ch h√†ng"}),t.jsx(l,{variant:"h5",sx:{my:.5,fontWeight:600},children:ae?.customerCount||0}),t.jsx(x,{sx:{display:"flex",alignItems:"center"},children:t.jsxs(l,{variant:"body2",color:"success.main",children:[t.jsx(T,{sx:{fontSize:16,mr:.5,verticalAlign:"text-bottom"}}),"5 kh√°ch m·ªõi trong tu·∫ßn"]})})]}),t.jsx(j,{sx:{bgcolor:"info.main",width:56,height:56},children:t.jsx(O,{})})]}),t.jsx(y,{}),t.jsxs(x,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:2},children:[t.jsx(l,{variant:"body2",color:"text.secondary",children:"Th√™m kh√°ch h√†ng m·ªõi"}),t.jsx(o,{size:"small",endIcon:t.jsx(A,{fontSize:"small"}),onClick:()=>te("/customers"),children:"Xem t·∫•t c·∫£"})]})]})})})]}),t.jsxs(a,{container:!0,spacing:3,children:[t.jsx(a,{item:!0,xs:12,md:8,children:t.jsxs(i,{sx:{p:3,borderRadius:2},children:[t.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",mb:2,alignItems:"center"},children:[t.jsx(l,{variant:"h6",fontWeight:600,children:"Bi·ªÉu ƒë·ªì doanh thu"}),t.jsxs(x,{children:[t.jsx(p,{label:"7 ng√†y",size:"small",clickable:!0,color:"week"===ge?"primary":"default",onClick:()=>ve("week"),sx:{mr:1}}),t.jsx(p,{label:"30 ng√†y",size:"small",clickable:!0,color:"month"===ge?"primary":"default",onClick:()=>ve("month"),sx:{mr:1}}),t.jsx(p,{label:"90 ng√†y",size:"small",clickable:!0,color:"quarter"===ge?"primary":"default",onClick:()=>ve("quarter")})]})]}),t.jsx(y,{sx:{mb:3}}),t.jsx(x,{sx:{height:300,width:"100%"},children:ae&&ae.salesChart&&ae.salesChart.length>0?t.jsx(V,{width:"100%",height:"100%",children:t.jsxs(Q,{data:ae.salesChart,margin:{top:5,right:30,left:20,bottom:5},children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"colorSales",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:ne.palette.primary.main,stopOpacity:.8}),t.jsx("stop",{offset:"95%",stopColor:ne.palette.primary.main,stopOpacity:.1})]})}),t.jsx(E,{strokeDasharray:"3 3",vertical:!1}),t.jsx(J,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fontSize:12}}),t.jsx(M,{axisLine:!1,tickLine:!1,tick:{fontSize:12},tickFormatter:e=>e>=1e6?e/1e6+"M":e/1e3+"K"}),t.jsx(U,{formatter:e=>K(e),labelFormatter:e=>`Ng√†y: ${e}`}),t.jsx(Y,{type:"monotone",dataKey:"sales",stroke:ne.palette.primary.main,fillOpacity:1,fill:"url(#colorSales)",name:"Doanh thu"})]})}):t.jsx(x,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(l,{color:"text.secondary",children:"Kh√¥ng c√≥ d·ªØ li·ªáu doanh thu"})})}),t.jsx(x,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:t.jsx(o,{variant:"text",endIcon:t.jsx(A,{}),onClick:()=>te("/reports"),children:"Xem t·∫•t c·∫£ b√°o c√°o"})})]})}),t.jsx(a,{item:!0,xs:12,md:4,children:t.jsxs(i,{sx:{p:3,height:"100%",borderRadius:2},children:[t.jsx(l,{variant:"h6",fontWeight:600,mb:2,children:"Ph√¢n b·ªï doanh thu"}),t.jsx(y,{sx:{mb:3}}),ae&&ae.salesByCategory&&ae.salesByCategory.length>0?t.jsx(x,{sx:{height:300,display:"flex",flexDirection:"column"},children:t.jsx(V,{width:"100%",height:"100%",children:t.jsxs(Z,{children:[t.jsx(ee,{data:ae.salesByCategory,cx:"50%",cy:"50%",innerRadius:70,outerRadius:90,paddingAngle:2,dataKey:"value",nameKey:"name",label:e=>e.name,children:ae.salesByCategory.map((e,s)=>t.jsx(se,{fill:be[s%be.length]},`cell-${s}`))}),t.jsx(U,{formatter:e=>K(e)})]})})}):t.jsx(x,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(l,{color:"text.secondary",children:"Kh√¥ng c√≥ d·ªØ li·ªáu ph√¢n b·ªï"})})]})}),t.jsx(a,{item:!0,xs:12,children:t.jsxs(i,{sx:{borderRadius:2},children:[t.jsxs(u,{value:pe,onChange:(e,s)=>{ue(s)},indicatorColor:"primary",textColor:"primary",children:[t.jsx(g,{label:"S·∫£n ph·∫©m b√°n ch·∫°y"}),t.jsx(g,{label:"Giao d·ªãch g·∫ßn ƒë√¢y"}),t.jsx(g,{label:"T·ªìn kho th·∫•p"})]}),t.jsx(y,{}),t.jsxs(x,{sx:{p:3},children:[0===pe&&t.jsxs(t.Fragment,{children:[t.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[t.jsx(l,{variant:"subtitle1",fontWeight:600,children:"Top s·∫£n ph·∫©m b√°n ch·∫°y trong tu·∫ßn"}),t.jsx(f,{size:"small",placeholder:"T√¨m s·∫£n ph·∫©m...",InputProps:{startAdornment:t.jsx(b,{position:"start",children:t.jsx(X,{fontSize:"small"})})},sx:{width:200}})]}),t.jsxs(a,{container:!0,spacing:2,children:[ae?.topProducts&&ae.topProducts.map(e=>t.jsx(a,{item:!0,xs:12,sm:6,md:3,children:t.jsx(h,{variant:"outlined",children:t.jsxs(x,{sx:{p:2},children:[t.jsxs(x,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(j,{alt:e.name,src:e.image,variant:"rounded",sx:{width:56,height:56,mr:2},children:e.name.charAt(0)}),t.jsxs(x,{children:[t.jsx(l,{variant:"subtitle2",noWrap:!0,children:e.name}),t.jsxs(l,{variant:"body2",color:"text.secondary",children:["ƒê√£ b√°n: ",e.quantity," ƒë∆°n v·ªã"]})]})]}),t.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2},children:[t.jsx(l,{variant:"body2",fontWeight:500,color:"primary",children:K(e.total)}),t.jsx(v,{size:"small",onClick:()=>te(`/products/${e.id}`),children:t.jsx($,{fontSize:"small"})})]})]})})},e.id)),(!ae?.topProducts||0===ae.topProducts.length)&&t.jsx(a,{item:!0,xs:12,children:t.jsx(x,{sx:{textAlign:"center",py:4},children:t.jsx(l,{color:"text.secondary",children:"Kh√¥ng c√≥ d·ªØ li·ªáu s·∫£n ph·∫©m b√°n ch·∫°y"})})})]}),t.jsx(x,{sx:{display:"flex",justifyContent:"center",mt:2},children:t.jsx(o,{variant:"outlined",onClick:()=>te("/reports/top-products"),children:"Xem t·∫•t c·∫£ s·∫£n ph·∫©m b√°n ch·∫°y"})})]}),1===pe&&t.jsxs(t.Fragment,{children:[t.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[t.jsx(l,{variant:"subtitle1",fontWeight:600,children:"Giao d·ªãch g·∫ßn ƒë√¢y"}),t.jsx(o,{variant:"text",startIcon:t.jsx(G,{}),onClick:()=>te("/sales/new"),children:"T·∫°o ƒë∆°n m·ªõi"})]}),ce.length>0?t.jsx(k,{disablePadding:!0,children:ce.map(e=>t.jsxs(C,{divider:!0,button:!0,onClick:()=>te(`/sales/${e.id}`),sx:{px:2,py:1.5},children:[t.jsx(w,{children:t.jsx(j,{sx:{bgcolor:"primary.main"},children:"cash"===e.payment_method?t.jsx(D,{}):"card"===e.payment_method?t.jsx(CreditCard,{}):t.jsx(H,{})})}),t.jsx(I,{primary:t.jsxs(x,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(l,{variant:"body1",fontWeight:500,sx:{mr:1},children:e.receipt_number}),t.jsx(p,{label:`${e.items_count} SP`,size:"small",color:"primary",variant:"outlined"})]}),secondary:t.jsxs(x,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(l,{variant:"body2",color:"text.secondary",sx:{mr:1},children:e.customer_name||"Kh√°ch v√£ng lai"}),t.jsx(l,{variant:"caption",color:"text.secondary",children:new Date(e.created_at).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit"})})]})}),t.jsx(l,{variant:"subtitle2",fontWeight:600,color:"primary.main",children:K(e.final_amount)})]},e.id))}):t.jsx(x,{sx:{textAlign:"center",py:4},children:t.jsx(l,{color:"text.secondary",children:"Kh√¥ng c√≥ d·ªØ li·ªáu giao d·ªãch g·∫ßn ƒë√¢y"})}),t.jsx(x,{sx:{display:"flex",justifyContent:"center",mt:2},children:t.jsx(o,{variant:"outlined",onClick:()=>te("/sales"),children:"Xem t·∫•t c·∫£ ƒë∆°n h√†ng"})})]}),2===pe&&t.jsxs(t.Fragment,{children:[t.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[t.jsx(l,{variant:"subtitle1",fontWeight:600,children:"S·∫£n ph·∫©m s·∫Øp h·∫øt h√†ng"}),t.jsx(o,{variant:"text",startIcon:t.jsx(G,{}),onClick:()=>te("/inventory/stock-in"),children:"Nh·∫≠p kho"})]}),de.length>0?t.jsx(a,{container:!0,spacing:2,children:de.map(e=>t.jsx(a,{item:!0,xs:12,sm:6,md:3,children:t.jsx(h,{variant:"outlined",children:t.jsxs(x,{sx:{p:2},children:[t.jsxs(x,{sx:{mb:1},children:[t.jsx(l,{variant:"subtitle2",gutterBottom:!0,children:e.name}),t.jsx(l,{variant:"caption",color:"text.secondary",display:"block",children:e.category_name})]}),t.jsxs(x,{sx:{mb:1},children:[t.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(l,{variant:"body2",children:"T·ªìn kho:"}),t.jsx(p,{label:e.stock_quantity,size:"small",color:0===e.stock_quantity?"error":"warning"})]}),t.jsx(S,{variant:"determinate",value:e.stock_quantity/e.stock_alert_threshold*100,sx:{mt:1,mb:1,height:6,borderRadius:1},color:0===e.stock_quantity?"error":"warning"}),t.jsxs(l,{variant:"caption",color:"text.secondary",children:["Ng∆∞·ª°ng c·∫£nh b√°o: ",e.stock_alert_threshold]})]}),t.jsx(o,{variant:"outlined",fullWidth:!0,size:"small",onClick:()=>te(`/products/${e.id}`),children:"Chi ti·∫øt"})]})})},e.id))}):t.jsx(x,{sx:{textAlign:"center",py:4},children:t.jsx(l,{color:"text.secondary",children:"Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o s·∫Øp h·∫øt h√†ng"})}),t.jsx(x,{sx:{display:"flex",justifyContent:"center",mt:2},children:t.jsx(o,{variant:"outlined",onClick:()=>te("/products?low_stock=true"),children:"Qu·∫£n l√Ω t·ªìn kho"})})]})]})]})})]})]})};export{te as default};
